# ğŸ“¦ Dokumentasi: Menghapus Item dari Local Storage

> **Catatan Penting**: Dokumentasi ini adalah lanjutan dari pembelajaran sebelumnya tentang Shopping List App. Pastikan kamu sudah memahami dasar-dasar Local Storage sebelum melanjutkan.

---

## ğŸ“‘ Daftar Isi

- [Pengenalan](#pengenalan)
- [Permasalahan yang Dihadapi](#permasalahan-yang-dihadapi)
- [Solusi: Refactoring Event Handler](#solusi-refactoring-event-handler)
- [Membuat Fungsi onClickItem](#membuat-fungsi-onclickitem)
- [Mengidentifikasi Element yang Diklik](#mengidentifikasi-element-yang-diklik)
- [Refactoring Fungsi removeItem](#refactoring-fungsi-removeitem)
- [Membuat Fungsi removeItemFromStorage](#membuat-fungsi-removeitemstorage)
- [Cara Kerja Filter Method](#cara-kerja-filter-method)
- [Menghapus Semua Item (Clear All)](#menghapus-semua-item-clear-all)
- [Testing Aplikasi](#testing-aplikasi)
- [Kode Lengkap script.js](#kode-lengkap-scriptjs)
- [Preview Berikutnya](#preview-berikutnya)
- [Kesimpulan](#kesimpulan)

---

<a name="pengenalan"></a>
## ğŸ¯ Pengenalan

Sekarang aplikasi Shopping List kita sudah bisa menambahkan item dan menyimpannya ke Local Storage. Tapi ada masalah! ğŸ¤”

Ketika kita klik tombol âŒ untuk menghapus item, item tersebut **hilang dari tampilan** tapi ketika kita **reload halaman**, item tersebut **muncul lagi**! 

Kenapa? Karena kita baru menghapus dari **DOM** (tampilan), tapi **belum menghapus dari Local Storage**. 

---

<a name="permasalahan-yang-dihadapi"></a>
## âš ï¸ Permasalahan yang Dihadapi

### Masalah Saat Ini:
- âœ… Item bisa dihapus dari tampilan (DOM)
- âŒ Item **TIDAK** terhapus dari Local Storage
- âŒ Setelah reload, item yang "dihapus" muncul lagi

### Yang Akan Kita Perbaiki:
1. Membuat fungsi untuk menghapus item dari Local Storage
2. Merefactor event handler agar lebih fleksibel (untuk fitur update nanti)
3. Menambahkan fungsi Clear All yang juga menghapus dari Local Storage

---

<a name="solusi-refactoring-event-handler"></a>
## ğŸ”§ Solusi: Refactoring Event Handler

Daripada langsung memanggil `removeItem()`, kita akan membuat fungsi **intermediary** bernama `onClickItem()`. 

### ğŸ¤” Kenapa Perlu Refactoring?

Karena nanti kita ingin menambahkan fitur **UPDATE**:
- Klik tombol âŒ â†’ Hapus item
- Klik item itu sendiri â†’ Muncul di form untuk di-update

Jadi kita perlu satu fungsi yang bisa **mendeteksi apa yang diklik**, lalu menentukan aksi yang tepat.

---

<a name="membuat-fungsi-onclickitem"></a>
## ğŸ†• Membuat Fungsi onClickItem

### Langkah 1: Ubah Event Listener

**Sebelumnya:**
```javascript
// Event listener lama (tidak ada di kode, tapi konsepnya begini)
itemList.addEventListener('click', removeItem);
```

**Sekarang:**
```javascript
// âœ¨ UBAH event listener
itemList.addEventListener('click', onClickItem); // ğŸ‘ˆ Panggil onClickItem dulu
```

### Langkah 2: Buat Fungsi onClickItem

Tambahkan fungsi baru **di atas fungsi removeItem**:

```javascript
// âœ¨ FUNGSI BARU
function onClickItem(e) {
  if (e.target.parentElement.classList.contains('remove-item')) {
    removeItem(e.target.parentElement.parentElement);
  }
}
```

### ğŸ“– Penjelasan Kode:

| Kode | Penjelasan |
|------|------------|
| `e.target` | Element yang **benar-benar diklik** (bisa icon, button, atau li) |
| `e.target.parentElement` | Element **parent** dari yang diklik |
| `.classList.contains('remove-item')` | Cek apakah parent punya class `remove-item` (ini adalah button) |
| `e.target.parentElement.parentElement` | Naik 2 level: dari icon â†’ button â†’ **li** (ini yang akan dihapus) |

---

<a name="mengidentifikasi-element-yang-diklik"></a>
## ğŸ” Mengidentifikasi Element yang Diklik

### Struktur HTML kita:

```html
<li>
  Juice
  <button class="remove-item btn-link text-red">
    <i class="fa-solid fa-xmark"></i> <!-- ğŸ‘ˆ Ini yang diklik user -->
  </button>
</li>
```

### Proses Identifikasi:

1. **User klik icon âŒ** â†’ `e.target` = `<i>` (icon)
2. **Ambil parent dari icon** â†’ `e.target.parentElement` = `<button>`
3. **Cek apakah button punya class 'remove-item'** â†’ `true` âœ…
4. **Ambil parent dari button** â†’ `e.target.parentElement.parentElement` = `<li>`
5. **Kirim `<li>` ke fungsi `removeItem()`**

### ğŸ§ª Testing dengan Console.log

Di video, instruktur melakukan testing:

```javascript
function onClickItem(e) {
  if (e.target.parentElement.classList.contains('remove-item')) {
    // ğŸ§ª Test 1: Cek apa yang diklik
    console.log(e.target.parentElement); // Output: <button class="remove-item">...</button>
    
    // ğŸ§ª Test 2: Cek parent dari button
    console.log(e.target.parentElement.parentElement); // Output: <li>Juice <button>...</button></li>
    
    removeItem(e.target.parentElement.parentElement);
  }
}
```

---

<a name="refactoring-fungsi-removeitem"></a>
## ğŸ”„ Refactoring Fungsi removeItem

Sekarang kita perbaiki fungsi `removeItem()` agar bisa menerima parameter.

### âš™ï¸ Kode Baru:

```javascript
// âœ¨ FUNGSI YANG DIUBAH
function removeItem(item) {  // ğŸ‘ˆ Terima parameter 'item' (element <li>)
  if (confirm('Are you sure?')) {  // ğŸ‘ˆ Konfirmasi dulu
    // Remove item from DOM
    item.remove();  // ğŸ‘ˆ Hapus element dari tampilan

    // Remove item from storage
    removeItemFromStorage(item.textContent);  // ğŸ‘ˆ Hapus dari Local Storage

    checkUI();  // ğŸ‘ˆ Update tampilan (hide/show filter & clear button)
  }
}
```

### ğŸ“– Penjelasan Detail:

#### 1ï¸âƒ£ `confirm('Are you sure?')`
- Menampilkan popup konfirmasi browser
- Return `true` jika user klik **OK**
- Return `false` jika user klik **Cancel**

#### 2ï¸âƒ£ `item.remove()`
- Method JavaScript untuk menghapus element dari DOM
- `item` adalah element `<li>` yang dikirim dari `onClickItem()`

#### 3ï¸âƒ£ `removeItemFromStorage(item.textContent)`
- Fungsi baru yang akan kita buat (lihat section berikutnya)
- `item.textContent` mengambil **text** dari `<li>`, contoh: "Juice"
- Kenapa perlu textContent? Karena di Local Storage kita simpan **text** bukan element HTML

#### 4ï¸âƒ£ `checkUI()`
- Fungsi untuk update UI (hide/show button Clear dan Filter)
- Sudah ada dari pembelajaran sebelumnya

---

<a name="membuat-fungsi-removeitemstorage"></a>
## ğŸ—‘ï¸ Membuat Fungsi removeItemFromStorage

Ini adalah fungsi kunci untuk menghapus item dari Local Storage!

### âš™ï¸ Kode Lengkap:

```javascript
// âœ¨ FUNGSI BARU
function removeItemFromStorage(item) {
  let itemsFromStorage = getItemsFromStorage();  // ğŸ‘ˆ 1. Ambil semua item

  // Filter out item to be removed
  itemsFromStorage = itemsFromStorage.filter((i) => i !== item);  // ğŸ‘ˆ 2. Filter (hapus item)

  // Re-set to localstorage
  localStorage.setItem('items', JSON.stringify(itemsFromStorage));  // ğŸ‘ˆ 3. Simpan kembali
}
```

### ğŸ“– Penjelasan Step by Step:

#### Step 1: Ambil Data dari Local Storage
```javascript
let itemsFromStorage = getItemsFromStorage();
```
- Ambil semua item yang ada di Local Storage
- Hasilnya berupa **array**, contoh: `["Eggs", "Milk", "Juice"]`

âš ï¸ **Bug Alert!** Di video ada error karena menggunakan `const`, harus diganti `let`:
```javascript
// âŒ SALAH - Error: assignment to constant variable
const itemsFromStorage = getItemsFromStorage();
itemsFromStorage = itemsFromStorage.filter(...); // Error!

// âœ… BENAR - Gunakan let agar bisa di-reassign
let itemsFromStorage = getItemsFromStorage();
itemsFromStorage = itemsFromStorage.filter(...); // OK!
```

#### Step 2: Filter Array (Hapus Item)
```javascript
itemsFromStorage = itemsFromStorage.filter((i) => i !== item);
```
- `filter()` adalah **Higher Order Array Method**
- Membuat array **baru** tanpa item yang ingin dihapus
- Contoh:
  ```javascript
  // Sebelum: ["Eggs", "Milk", "Juice"]
  // Hapus "Eggs"
  // Sesudah: ["Milk", "Juice"]
  ```

#### Step 3: Simpan Kembali ke Local Storage
```javascript
localStorage.setItem('items', JSON.stringify(itemsFromStorage));
```
- **Overwrite** data lama dengan data baru (yang sudah dihapus itemnya)
- `JSON.stringify()` mengubah array menjadi string untuk disimpan

---

<a name="cara-kerja-filter-method"></a>
## ğŸ“ Cara Kerja Filter Method

### Konsep Filter:
Filter adalah method array yang **membuat array baru** berisi element yang **lolos kondisi**.

### Contoh Sederhana:

```javascript
const numbers = [1, 2, 3, 4, 5];

// Filter angka yang LEBIH DARI 2
const filtered = numbers.filter((num) => num > 2);

console.log(filtered); // Output: [3, 4, 5]
console.log(numbers);  // Output: [1, 2, 3, 4, 5] (array asli tidak berubah)
```

### Penerapan di Kasus Kita:

```javascript
const items = ["Eggs", "Milk", "Juice"];
const itemToRemove = "Eggs";

// Filter: ambil semua item KECUALI "Eggs"
const newItems = items.filter((i) => i !== itemToRemove);

console.log(newItems); // Output: ["Milk", "Juice"]
```

### ğŸ” Breakdown Kode Filter:

```javascript
itemsFromStorage.filter((i) => i !== item)
//                      |  |    |
//                      |  |    â””â”€ Kondisi: 'i' tidak sama dengan 'item' yang dihapus
//                      |  â””â”€â”€â”€â”€â”€â”€ Arrow function
//                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Parameter: setiap item dalam loop
```

### Visualisasi Proses:

| Loop | Item (i) | item (yang dihapus) | i !== item | Masuk ke array baru? |
|------|----------|---------------------|------------|----------------------|
| 1 | "Eggs" | "Eggs" | `false` | âŒ Tidak |
| 2 | "Milk" | "Eggs" | `true` | âœ… Ya |
| 3 | "Juice" | "Eggs" | `true` | âœ… Ya |

**Hasil akhir:** `["Milk", "Juice"]`

---

<a name="menghapus-semua-item-clear-all"></a>
## ğŸ§¹ Menghapus Semua Item (Clear All)

Sekarang kita tambahkan fungsi untuk menghapus **SEMUA** item sekaligus dengan tombol "Clear All".

### âš™ï¸ Update Fungsi clearItems:

```javascript
function clearItems() {
  while (itemList.firstChild) {
    itemList.removeChild(itemList.firstChild);  // ğŸ‘ˆ Hapus dari DOM
  }

  // âœ¨ TAMBAHKAN KODE INI
  // Clear from localStorage
  localStorage.removeItem('items');  // ğŸ‘ˆ Hapus dari Local Storage

  checkUI();
}
```

### ğŸ“– Penjelasan:

#### Bagian 1: Hapus dari DOM (sudah ada sebelumnya)
```javascript
while (itemList.firstChild) {
  itemList.removeChild(itemList.firstChild);
}
```
- Loop selama masih ada child di `<ul id="item-list">`
- Hapus child pertama berulang-ulang sampai kosong

#### Bagian 2: Hapus dari Local Storage (BARU)
```javascript
localStorage.removeItem('items');
```
- Menghapus **seluruh key 'items'** dari Local Storage
- Setelah ini, `localStorage.getItem('items')` akan return `null`

### ğŸ¤” Alternatif: localStorage.clear()

Di video, instruktur menyebut ada alternatif:

```javascript
// Opsi 1: Hapus key tertentu (LEBIH AMAN)
localStorage.removeItem('items'); // ğŸ‘ˆ Kita pakai ini

// Opsi 2: Hapus SEMUA Local Storage (HATI-HATI!)
localStorage.clear(); // ğŸ‘ˆ Hapus SEMUA key, bukan hanya 'items'
```

**ğŸ’¡ Kapan pakai yang mana?**
- Jika aplikasi hanya pakai 1 key (`items`) â†’ Pakai `clear()` atau `removeItem()` sama saja
- Jika aplikasi pakai banyak key â†’ Pakai `removeItem('items')` agar key lain tidak terhapus

---

<a name="testing-aplikasi"></a>
## ğŸ§ª Testing Aplikasi

### Test 1: Hapus Single Item

1. Tambah beberapa item: "Eggs", "Milk", "Juice"
2. Klik tombol âŒ di "Eggs"
3. Klik **OK** di popup konfirmasi
4. âœ… "Eggs" hilang dari tampilan
5. Reload halaman (`F5`)
6. âœ… "Eggs" tetap hilang (tidak muncul lagi)

### Test 2: Cek Local Storage

Buka **DevTools** â†’ **Application** â†’ **Local Storage** â†’ `http://localhost...`

**Sebelum hapus:**
```json
["Eggs", "Milk", "Juice"]
```

**Setelah hapus "Eggs":**
```json
["Milk", "Juice"]
```

### Test 3: Hapus Semua Item

1. Klik tombol **"Clear All"**
2. âœ… Semua item hilang
3. âœ… Tombol "Clear All" dan "Filter" ikut hilang (karena `checkUI()`)
4. Reload halaman
5. âœ… Tetap kosong (tidak muncul lagi)

### Test 4: Cek Local Storage Setelah Clear All

Buka **DevTools** â†’ **Application** â†’ **Local Storage**

âœ… Key `items` sudah **tidak ada** (terhapus)

---

<a name="kode-lengkap-scriptjs"></a>
## ğŸ“„ Kode Lengkap script.js

Berikut kode lengkap dengan **highlight pada bagian yang diubah/ditambah**:

```javascript
const itemForm = document.getElementById('item-form');
const itemInput = document.getElementById('item-input');
const itemList = document.getElementById('item-list');
const clearBtn = document.getElementById('clear');
const itemFilter = document.getElementById('filter');

function displayItems() {
  const itemsFromStorage = getItemsFromStorage();
  itemsFromStorage.forEach((item) => addItemToDOM(item));
  checkUI();
}

function onAddItemSubmit(e) {
  e.preventDefault();

  const newItem = itemInput.value;

  // Validate Input
  if (newItem === '') {
    alert('Please add an item');
    return;
  }

  // Create item DOM element
  addItemToDOM(newItem);

  // Add item to local storage
  addItemToStorage(newItem);

  checkUI();

  itemInput.value = '';
}

function addItemToDOM(item) {
  // Create list item
  const li = document.createElement('li');
  li.appendChild(document.createTextNode(item));

  const button = createButton('remove-item btn-link text-red');
  li.appendChild(button);

  // Add li to the DOM
  itemList.appendChild(li);
}

function createButton(classes) {
  const button = document.createElement('button');
  button.className = classes;
  const icon = createIcon('fa-solid fa-xmark');
  button.appendChild(icon);
  return button;
}

function createIcon(classes) {
  const icon = document.createElement('i');
  icon.className = classes;
  return icon;
}

function addItemToStorage(item) {
  const itemsFromStorage = getItemsFromStorage();

  // Add new item to array
  itemsFromStorage.push(item);

  // Convert to JSON string and set to local storage
  localStorage.setItem('items', JSON.stringify(itemsFromStorage));
}

function getItemsFromStorage() {
  let itemsFromStorage;

  if (localStorage.getItem('items') === null) {
    itemsFromStorage = [];
  } else {
    itemsFromStorage = JSON.parse(localStorage.getItem('items'));
  }

  return itemsFromStorage;
}

// âœ¨ FUNGSI BARU
function onClickItem(e) {
  if (e.target.parentElement.classList.contains('remove-item')) {
    removeItem(e.target.parentElement.parentElement);
  }
}

// âœ¨ FUNGSI YANG DIUBAH
function removeItem(item) {
  if (confirm('Are you sure?')) {
    // Remove item from DOM
    item.remove();

    // Remove item from storage
    removeItemFromStorage(item.textContent);

    checkUI();
  }
}

// âœ¨ FUNGSI BARU
function removeItemFromStorage(item) {
  let itemsFromStorage = getItemsFromStorage();  // ğŸ‘ˆ Gunakan 'let' bukan 'const'

  // Filter out item to be removed
  itemsFromStorage = itemsFromStorage.filter((i) => i !== item);

  // Re-set to localstorage
  localStorage.setItem('items', JSON.stringify(itemsFromStorage));
}

// âœ¨ FUNGSI YANG DIUBAH
function clearItems() {
  while (itemList.firstChild) {
    itemList.removeChild(itemList.firstChild);
  }

  // âœ¨ BARIS BARU: Clear from localStorage
  localStorage.removeItem('items');

  checkUI();
}

function filterItems(e) {
  const items = itemList.querySelectorAll('li');
  const text = e.target.value.toLowerCase();

  items.forEach((item) => {
    const itemName = item.firstChild.textContent.toLowerCase();

    if (itemName.indexOf(text) != -1) {
      item.style.display = 'flex';
    } else {
      item.style.display = 'none';
    }
  });
}

function checkUI() {
  const items = itemList.querySelectorAll('li');

  if (items.length === 0) {
    clearBtn.style.display = 'none';
    itemFilter.style.display = 'none';
  } else {
    clearBtn.style.display = 'block';
    itemFilter.style.display = 'block';
  }
}

// Initialize app
function init() {
  // Event Listeners
  itemForm.addEventListener('submit', onAddItemSubmit);
  itemList.addEventListener('click', onClickItem);  // âœ¨ DIUBAH dari removeItem
  clearBtn.addEventListener('click', clearItems);
  itemFilter.addEventListener('input', filterItems);
  document.addEventListener('DOMContentLoaded', displayItems);

  checkUI();
}

init();
```

---

<a name="preview-berikutnya"></a>
## ğŸ¬ Preview Berikutnya: Fitur UPDATE

Di akhir video, instruktur menyebut fitur berikutnya yang akan dibuat:

### ğŸ¯ Goal Fitur Update:
1. User **klik pada item** (bukan tombol âŒ)
2. Text item muncul di **input field**
3. Tombol berubah dari **"+ Add Item"** menjadi **"âœï¸ Update Item"**
4. User bisa **edit text** dan klik update
5. Item di list **berubah** sesuai edit

Ini sebabnya kita membuat fungsi `onClickItem()` di awal â€” agar bisa mendeteksi:
- Klik tombol âŒ â†’ Hapus item
- Klik item â†’ Edit item (fitur berikutnya)

---

<a name="kesimpulan"></a>
## ğŸ‰ Kesimpulan

### âœ… Apa yang Sudah Kita Pelajari:

1. **Refactoring Event Handler**
   - Membuat fungsi `onClickItem()` sebagai "penengah"
   - Mengidentifikasi element yang diklik dengan `e.target`

2. **Menghapus Item dari DOM & Local Storage**
   - Fungsi `removeItem()` untuk hapus dari DOM
   - Fungsi `removeItemFromStorage()` untuk hapus dari Local Storage
   - Menggunakan `filter()` method untuk menghapus item dari array

3. **Menghapus Semua Item**
   - Update fungsi `clearItems()` agar juga hapus dari Local Storage
   - Menggunakan `localStorage.removeItem()`

4. **Error Handling**
   - Bug `const` vs `let` saat reassign variable
   - Pentingnya konfirmasi dengan `confirm()`

### ğŸ”‘ Konsep Penting:

| Konsep | Penjelasan |
|--------|------------|
| `filter()` | Method array untuk membuat array baru tanpa element tertentu |
| `item.remove()` | Method untuk menghapus element dari DOM |
| `localStorage.removeItem()` | Menghapus key tertentu dari Local Storage |
| `localStorage.clear()` | Menghapus SEMUA key dari Local Storage |
| `confirm()` | Popup konfirmasi browser (OK/Cancel) |

### ğŸš€ Next Step:

Fitur **UPDATE ITEM** â€” Klik item untuk edit! 

---

**ğŸ“š Dokumentasi Pribadi - Belajar JavaScript Local Storage Step by Step**

*Semangat belajar! ğŸ’ª*
