# üé¨ Alternatif Saran Refactoring

## üìë Daftar Isi
- [Chat GPT](#chat-gpt)
- [Claude AI](#claude-ai)

<a name="chat-gpt"></a>
### Chat GPT

<details>
<summary> Lihat Kode Full (klik untuk expand) </summary>

```javascript
/* =====================================================
   üåç APP STATE & CONFIG
===================================================== */

const global = {
  currentPage: window.location.pathname,
  api: {
    apiKey: '3fd2be6f0c70a2a598f084ddfb75487c',
    apiUrl: 'https://api.themoviedb.org/3/',
    imageBaseUrl: 'https://image.tmdb.org/t/p/w500',
    imageOriginalUrl: 'https://image.tmdb.org/t/p/original',
  },
};

/* =====================================================
   üÜï‚ú® SEARCH STATE (REFACTORED)
===================================================== */

const searchState = {
  term: '',
  type: '',
  page: 1,
  totalPages: 1,
  totalResults: 0,
};

/* =====================================================
   üß∞ DOM HELPERS
===================================================== */

const getElement = (selector) => document.querySelector(selector);

/* =====================================================
   ‚è≥ LOADING SPINNER
===================================================== */

const showSpinner = () => {
  getElement('.spinner')?.classList.add('show');
};

const hideSpinner = () => {
  getElement('.spinner')?.classList.remove('show');
};

/* =====================================================
   üåê API HANDLERS
===================================================== */

const fetchFromTMDB = async (endpoint) => {
  showSpinner();

  const response = await fetch(
    `${global.api.apiUrl}${endpoint}?api_key=${global.api.apiKey}&language=en-US`
  );

  const data = await response.json();
  hideSpinner();

  return data;
};

/* =====================================================
   üÜï‚ú® SEARCH API HANDLER (CLEAN)
===================================================== */

const fetchSearchResults = async () => {
  showSpinner();

  const response = await fetch(
    `${global.api.apiUrl}search/${searchState.type}?api_key=${
      global.api.apiKey
    }&language=en-US&query=${searchState.term}&page=${searchState.page}`
  );

  const data = await response.json();
  hideSpinner();

  return data;
};

/* =====================================================
   üé¥ CARD FACTORIES
===================================================== */

const createMovieCard = (movie) => {
  const card = document.createElement('div');
  card.classList.add('card');

  const image = movie.poster_path
    ? `${global.api.imageBaseUrl}${movie.poster_path}`
    : '../images/no-image.jpg';

  card.innerHTML = `
    <a href="movie-details.html?id=${movie.id}">
      <img src="${image}" class="card-img-top" alt="${movie.title}" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${movie.title}</h5>
      <p class="card-text">
        <small class="text-muted">Release: ${movie.release_date || '-'}</small>
      </p>
    </div>
  `;

  return card;
};

const createTvShowCard = (show) => {
  const card = document.createElement('div');
  card.classList.add('card');

  const image = show.poster_path
    ? `${global.api.imageBaseUrl}${show.poster_path}`
    : '../images/no-image.jpg';

  card.innerHTML = `
    <a href="tv-details.html?id=${show.id}">
      <img src="${image}" class="card-img-top" alt="${show.name}" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${show.name}</h5>
      <p class="card-text">
        <small class="text-muted">Air Date: ${
          show.first_air_date || '-'
        }</small>
      </p>
    </div>
  `;

  return card;
};

/* =====================================================
   üÜï‚ú® SEARCH RESULT CARD
===================================================== */

const createSearchResultCard = (item) => {
  const card = document.createElement('div');
  card.classList.add('card');

  const title =
    searchState.type === 'movie' ? item.title : item.name;

  const date =
    searchState.type === 'movie'
      ? item.release_date
      : item.first_air_date;

  const image = item.poster_path
    ? `${global.api.imageBaseUrl}${item.poster_path}`
    : '../images/no-image.jpg';

  card.innerHTML = `
    <a href="${searchState.type}-details.html?id=${item.id}">
      <img src="${image}" class="card-img-top" alt="${title}" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${title}</h5>
      <p class="card-text">
        <small class="text-muted">Release: ${date || '-'}</small>
      </p>
    </div>
  `;

  return card;
};

/* =====================================================
   üé• RENDER FUNCTIONS
===================================================== */

const renderMovies = (movies) => {
  const container = getElement('#popular-movies');
  movies.forEach((movie) =>
    container.appendChild(createMovieCard(movie))
  );
};

const renderTvShows = (shows) => {
  const container = getElement('#popular-shows');
  shows.forEach((show) =>
    container.appendChild(createTvShowCard(show))
  );
};

/* =====================================================
   üÜï‚ú® SEARCH PAGE CONTROLLER
===================================================== */

const handleSearchPage = async () => {
  const params = new URLSearchParams(window.location.search);

  searchState.term = params.get('search-term');
  searchState.type = params.get('type');
  searchState.page = 1;

  if (!isValidSearchTerm(searchState.term)) {
    showAlert('Please enter a search term');
    return;
  }

  await fetchAndRenderSearchResults();
};

/* =====================================================
   üÜï‚ú® SEARCH FLOW WRAPPER (BEST PRACTICE)
===================================================== */

const fetchAndRenderSearchResults = async () => {
  const data = await fetchSearchResults();

  searchState.totalPages = data.total_pages;
  searchState.totalResults = data.total_results;

  if (data.results.length === 0) {
    showAlert('No results found');
    return;
  }

  renderSearchResults(data.results);
  renderSearchPagination();
};

/* =====================================================
   üÜï‚ú® SEARCH RENDERERS
===================================================== */

const renderSearchResults = (results) => {
  const resultsContainer = getElement('#search-results');
  const headingContainer = getElement('#search-results-heading');

  resultsContainer.innerHTML = '';
  headingContainer.innerHTML = `
    <h2>${results.length} of ${
    searchState.totalResults
  } Results for "${searchState.term}"</h2>
  `;

  results.forEach((item) => {
    resultsContainer.appendChild(createSearchResultCard(item));
  });
};

/* =====================================================
   üÜï‚ú® PAGINATION UI
===================================================== */

const renderSearchPagination = () => {
  const paginationContainer = getElement('#pagination');
  paginationContainer.innerHTML = '';

  const pagination = document.createElement('div');
  pagination.classList.add('pagination');

  pagination.innerHTML = `
    <button class="btn btn-primary" id="prev-page">Prev</button>
    <button class="btn btn-primary" id="next-page">Next</button>
    <span class="page-counter">
      Page ${searchState.page} of ${searchState.totalPages}
    </span>
  `;

  paginationContainer.appendChild(pagination);
  setupPaginationEvents();
};

/* =====================================================
   üÜï‚ú® PAGINATION LOGIC
===================================================== */

const setupPaginationEvents = () => {
  const prevBtn = getElement('#prev-page');
  const nextBtn = getElement('#next-page');

  prevBtn.disabled = searchState.page === 1;
  nextBtn.disabled = searchState.page === searchState.totalPages;

  prevBtn.addEventListener('click', () => changeSearchPage(-1));
  nextBtn.addEventListener('click', () => changeSearchPage(1));
};

const changeSearchPage = async (direction) => {
  searchState.page += direction;
  await fetchAndRenderSearchResults();
};

/* =====================================================
   üîç HELPERS
===================================================== */

const isValidSearchTerm = (term) =>
  term !== null && term.trim() !== '';

const showAlert = (message, className = 'alert-danger') => {
  const alertContainer = getElement('#alert');
  if (!alertContainer) return;

  alertContainer.innerHTML = '';
  const alert = document.createElement('div');
  alert.className = `alert ${className}`;
  alert.textContent = message;

  alertContainer.appendChild(alert);
  setTimeout(() => alert.remove(), 3000);
};

/* =====================================================
   üé¨ PAGE CONTROLLERS
===================================================== */

const loadPopularMovies = async () => {
  const data = await fetchFromTMDB('movie/popular');
  renderMovies(data.results);
};

const loadPopularTvShows = async () => {
  const data = await fetchFromTMDB('tv/popular');
  renderTvShows(data.results);
};

/* =====================================================
   üß≠ NAVIGATION
===================================================== */

const highlightActiveNavigation = () => {
  document.querySelectorAll('.nav-link').forEach((link) => {
    if (link.getAttribute('href') === global.currentPage) {
      link.classList.add('active');
    }
  });
};

/* =====================================================
   üöÄ APP INITIALIZER
===================================================== */

const init = () => {
  switch (global.currentPage) {
    case '/':
    case '/index.html':
      loadPopularMovies();
      break;

    case '/shows.html':
      loadPopularTvShows();
      break;

    case '/search.html': // üÜï‚ú®
      handleSearchPage();
      break;
  }

  highlightActiveNavigation();
};

document.addEventListener('DOMContentLoaded', init);

```

</details>

<a name="claude-ai"></a>
### Claude AI

<details>
<summary> Lihat Kode Full (klik untuk expand) </summary>

```javascript
// ============================================
// üì¶ PART 1 of 4: CONSTANTS + UTILITIES + SPINNER + ALERT
// ============================================

// ============================================
// CONSTANTS - Kumpulan nilai tetap
// ============================================
const CONFIG = {
  API_KEY: '', // ‚ö†Ô∏è ISI DENGAN API KEY ANDA dari https://www.themoviedb.org/settings/api
  API_BASE_URL: 'https://api.themoviedb.org/3/',
  IMAGE_BASE_URL: 'https://image.tmdb.org/t/p/w500',
  BACKDROP_IMAGE_URL: 'https://image.tmdb.org/t/p/original',
  NO_IMAGE_PATH: '../images/no-image.jpg',
  LANGUAGE: 'en-US'
};

const PAGES = {
  HOME: '/',
  INDEX: '/index.html',
  SHOWS: '/shows.html',
  MOVIE_DETAILS: '/movie-details.html',
  TV_DETAILS: '/tv-details.html',
  SEARCH: '/search.html'
};

const SELECTORS = {
  SPINNER: '.spinner',
  POPULAR_SHOWS: '#popular-shows',
  POPULAR_MOVIES: '#popular-movies',
  MOVIE_DETAILS_CONTAINER: '#movie-details',
  SHOW_DETAILS_CONTAINER: '#show-details',
  NAV_LINKS: '.nav-link',
  SWIPER_WRAPPER: '.swiper-wrapper',
  SWIPER_CONTAINER: '.swiper'
};

const CSS_CLASSES = {
  SPINNER_SHOW: 'show',
  CARD: 'card',
  ACTIVE_LINK: 'active',
  DETAILS_BACKDROP: 'details-backdrop',
  SWIPER_SLIDE: 'swiper-slide',
  SWIPER_RATING: 'swiper-rating'
};

const API_ENDPOINTS = {
  POPULAR_MOVIES: 'movie/popular',
  POPULAR_SHOWS: 'tv/popular',
  MOVIE_DETAIL: 'movie',
  TV_DETAIL: 'tv',
  NOW_PLAYING: 'movie/now_playing'
};

const SWIPER_CONFIG = {
  slidesPerView: 1,
  spaceBetween: 30,
  freeMode: true,
  loop: true,
  autoplay: {
    delay: 4000,
    disableOnInteraction: false
  },
  breakpoints: {
    500: { slidesPerView: 2 },
    700: { slidesPerView: 3 },
    1200: { slidesPerView: 4 }
  }
};

// üÜïüîç SEARCH CONFIGURATION
const SEARCH_CONFIG = {
  MIN_TERM_LENGTH: 3,
  ALERT_DURATION: 3000,
  SEARCH_TYPES: {
    MOVIE: 'movie',
    TV: 'tv'
  }
};

const SEARCH_SELECTORS = {
  SEARCH_FORM: '#search-form',
  SEARCH_INPUT: '#search-term',
  SEARCH_TYPE_RADIO: 'input[name="type"]',
  SEARCH_RESULTS: '#search-results',
  SEARCH_HEADING: '#search-results-heading',
  ALERT_CONTAINER: '#alert',
  PAGINATION: '#pagination'
};

// üÜïüé® ALERT TYPES
const ALERT_TYPES = {
  SUCCESS: 'alert-success',
  ERROR: 'alert-error',
  INFO: 'alert-info',
  WARNING: 'alert-warning'
};

// üÜïüÜïüî¢ PAGINATION SELECTORS (sesuai dengan HTML yang ada)
const PAGINATION_SELECTORS = {
  CONTAINER: '#pagination',
  PREV_BUTTON: '#prev',
  NEXT_BUTTON: '#next'
};

// üÜïüÜïüî¢ SEARCH STATE - Menyimpan data pencarian & pagination
const SEARCH_STATE = {
  searchTerm: '',
  searchType: 'movie',
  currentPage: 1,
  totalPages: 1,
  totalResults: 0
};

// ============================================
// UTILITY FUNCTIONS
// ============================================
const getImageUrl = (posterPath) => {
  if (posterPath) {
    return `${CONFIG.IMAGE_BASE_URL}${posterPath}`;
  }
  return CONFIG.NO_IMAGE_PATH;
};

const getCurrentPage = () => {
  return window.location.pathname;
};

const getQueryParam = (paramName) => {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(paramName);
};

const getMovieIdFromUrl = () => {
  return getQueryParam('id');
};

const getShowIdFromUrl = () => {
  return getQueryParam('id');
};

// üÜïüîç SEARCH URL HELPERS
const getSearchTermFromUrl = () => {
  return getQueryParam('search-term') || '';
};

const getSearchTypeFromUrl = () => {
  const type = getQueryParam('type');
  return type === SEARCH_CONFIG.SEARCH_TYPES.TV 
    ? SEARCH_CONFIG.SEARCH_TYPES.TV 
    : SEARCH_CONFIG.SEARCH_TYPES.MOVIE;
};

const getPageFromUrl = () => {
  const page = getQueryParam('page');
  return page ? parseInt(page, 10) : 1;
};

const formatNumberWithCommas = (number) => {
  if (!number || number === 0) return '0';
  return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
};

// ============================================
// SPINNER FUNCTIONS
// ============================================
const showSpinner = () => {
  const spinner = document.querySelector(SELECTORS.SPINNER);
  if (spinner) {
    spinner.classList.add(CSS_CLASSES.SPINNER_SHOW);
  }
};

const hideSpinner = () => {
  const spinner = document.querySelector(SELECTORS.SPINNER);
  if (spinner) {
    spinner.classList.remove(CSS_CLASSES.SPINNER_SHOW);
  }
};

// üÜïüé® CUSTOM ALERT FUNCTIONS
const getAlertIcon = (type) => {
  const icons = {
    [ALERT_TYPES.SUCCESS]: '‚úì',
    [ALERT_TYPES.ERROR]: '‚ö†Ô∏è',
    [ALERT_TYPES.INFO]: '‚ÑπÔ∏è',
    [ALERT_TYPES.WARNING]: '‚ö°'
  };
  return icons[type] || icons[ALERT_TYPES.INFO];
};

const createAlertElement = (message, type = ALERT_TYPES.INFO) => {
  const alertDiv = document.createElement('div');
  alertDiv.classList.add('alert', type);
  const icon = getAlertIcon(type);
  alertDiv.innerHTML = `
    <span class="alert-icon">${icon}</span>
    <span class="alert-message">${message}</span>
  `;
  return alertDiv;
};

const showAlert = (message, type = ALERT_TYPES.INFO, duration = SEARCH_CONFIG.ALERT_DURATION) => {
  const container = document.querySelector(SEARCH_SELECTORS.ALERT_CONTAINER);
  if (!container) {
    console.error('‚ùå Alert container tidak ditemukan!');
    return;
  }
  const alertElement = createAlertElement(message, type);
  container.appendChild(alertElement);
  setTimeout(() => {
    alertElement.remove();
  }, duration);
  console.log(`üì¢ Alert ditampilkan: ${message}`);
};

const showSuccessAlert = (message) => showAlert(message, ALERT_TYPES.SUCCESS);
const showErrorAlert = (message) => showAlert(message, ALERT_TYPES.ERROR);
const showInfoAlert = (message) => showAlert(message, ALERT_TYPES.INFO);
const showWarningAlert = (message) => showAlert(message, ALERT_TYPES.WARNING);

// ============================================
// ‚úÖ END OF PART 1
// ‚¨áÔ∏è Lanjutkan dengan PART 2
// ============================================

// ============================================
// üì¶ PART 2 of 4: API FUNCTIONS + VALIDATION + CARD CREATION
// ============================================

// ============================================
// API FUNCTIONS
// ============================================
const fetchFromAPI = async (endpoint) => {
  if (!CONFIG.API_KEY) {
    console.error('‚ùå API Key belum diisi!');
    return null;
  }
  const url = `${CONFIG.API_BASE_URL}${endpoint}?api_key=${CONFIG.API_KEY}&language=${CONFIG.LANGUAGE}`;
  showSpinner();
  try {
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`HTTP Error! Status: ${response.status}`);
    }
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('‚ùå Error fetching data:', error.message);
    return null;
  } finally {
    hideSpinner();
  }
};

const fetchPopularMovies = async () => {
  const data = await fetchFromAPI(API_ENDPOINTS.POPULAR_MOVIES);
  return data?.results || [];
};

const fetchPopularShows = async () => {
  const data = await fetchFromAPI(API_ENDPOINTS.POPULAR_SHOWS);
  return data?.results || [];
};

const fetchMovieDetail = async (movieId) => {
  if (!movieId) {
    console.error('‚ùå Movie ID tidak valid!');
    return null;
  }
  const endpoint = `${API_ENDPOINTS.MOVIE_DETAIL}/${movieId}`;
  const data = await fetchFromAPI(endpoint);
  return data;
};

const fetchShowDetail = async (showId) => {
  if (!showId) {
    console.error('‚ùå Show ID tidak valid!');
    return null;
  }
  const endpoint = `${API_ENDPOINTS.TV_DETAIL}/${showId}`;
  const data = await fetchFromAPI(endpoint);
  return data;
};

const fetchNowPlayingMovies = async () => {
  const data = await fetchFromAPI(API_ENDPOINTS.NOW_PLAYING);
  return data?.results || [];
};

// üÜïüîç SEARCH API FUNCTION
const searchMoviesOrShows = async (searchTerm, searchType, page = 1) => {
  if (!CONFIG.API_KEY) {
    console.error('‚ùå API Key belum diisi!');
    showErrorAlert('API Key tidak tersedia.');
    return null;
  }
  const encodedTerm = encodeURIComponent(searchTerm);
  const endpoint = `search/${searchType}`;
  const url = `${CONFIG.API_BASE_URL}${endpoint}?api_key=${CONFIG.API_KEY}&language=${CONFIG.LANGUAGE}&query=${encodedTerm}&page=${page}`;
  showSpinner();
  try {
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`HTTP Error! Status: ${response.status}`);
    }
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('‚ùå Error searching data:', error.message);
    showErrorAlert('Terjadi kesalahan saat mencari data.');
    return null;
  } finally {
    hideSpinner();
  }
};

// üÜïüîç SEARCH VALIDATION
const validateSearchTerm = (searchTerm) => {
  if (!searchTerm || searchTerm.trim() === '') {
    return {
      isValid: false,
      message: 'Silakan masukkan kata kunci pencarian!'
    };
  }
  if (searchTerm.trim().length < SEARCH_CONFIG.MIN_TERM_LENGTH) {
    return {
      isValid: false,
      message: `Minimal ${SEARCH_CONFIG.MIN_TERM_LENGTH} karakter!`
    };
  }
  return {
    isValid: true,
    message: ''
  };
};

// ============================================
// CARD CREATION FUNCTIONS
// ============================================
const createMovieCard = (movie) => {
  const card = document.createElement('div');
  card.classList.add(CSS_CLASSES.CARD);
  const imageUrl = getImageUrl(movie.poster_path);
  const movieTitle = movie.title || 'Unknown Title';
  const releaseDate = movie.release_date || 'N/A';
  card.innerHTML = `
    <a href="movie-details.html?id=${movie.id}">
      <img src="${imageUrl}" class="card-img-top" alt="${movieTitle}" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${movieTitle}</h5>
      <p class="card-text">
        <small class="text-muted">Release: ${releaseDate}</small>
      </p>
    </div>
  `;
  return card;
};

const createShowCard = (show) => {
  const card = document.createElement('div');
  card.classList.add(CSS_CLASSES.CARD);
  const imageUrl = getImageUrl(show.poster_path);
  const showName = show.name || 'Unknown Title';
  const airDate = show.first_air_date || 'N/A';
  card.innerHTML = `
    <a href="tv-details.html?id=${show.id}">
      <img src="${imageUrl}" class="card-img-top" alt="${showName}" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${showName}</h5>
      <p class="card-text">
        <small class="text-muted">Air Date: ${airDate}</small>
      </p>
    </div>
  `;
  return card;
};

const createSwiperSlide = (movie) => {
  const slide = document.createElement('div');
  slide.classList.add(CSS_CLASSES.SWIPER_SLIDE);
  const movieId = movie.id;
  const imageUrl = `${CONFIG.IMAGE_BASE_URL}${movie.poster_path}`;
  const title = movie.title || 'Unknown Title';
  const rating = movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A';
  slide.innerHTML = `
    <a href="movie-details.html?id=${movieId}">
      <img src="${imageUrl}" alt="${title}" loading="lazy" />
    </a>
    <h4 class="${CSS_CLASSES.SWIPER_RATING}">
      <i class="fas fa-star text-secondary"></i> ${rating} / 10
    </h4>
  `;
  return slide;
};

// üÜïüîç SEARCH CARD CREATION
const createSearchMovieCard = (movie) => {
  const card = document.createElement('div');
  card.classList.add(CSS_CLASSES.CARD);
  const imageUrl = getImageUrl(movie.poster_path);
  const title = movie.title || 'Unknown Title';
  const releaseDate = movie.release_date || 'N/A';
  card.innerHTML = `
    <a href="movie-details.html?id=${movie.id}">
      <img src="${imageUrl}" class="card-img-top" alt="${title}" loading="lazy" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${title}</h5>
      <p class="card-text">
        <small class="text-muted">Release: ${releaseDate}</small>
      </p>
    </div>
  `;
  return card;
};

const createSearchShowCard = (show) => {
  const card = document.createElement('div');
  card.classList.add(CSS_CLASSES.CARD);
  const imageUrl = getImageUrl(show.poster_path);
  const name = show.name || 'Unknown Title';
  const airDate = show.first_air_date || 'N/A';
  card.innerHTML = `
    <a href="tv-details.html?id=${show.id}">
      <img src="${imageUrl}" class="card-img-top" alt="${name}" loading="lazy" />
    </a>
    <div class="card-body">
      <h5 class="card-title">${name}</h5>
      <p class="card-text">
        <small class="text-muted">First Air: ${airDate}</small>
      </p>
    </div>
  `;
  return card;
};

// ============================================
// BACKDROP FUNCTIONS
// ============================================
const getBackdropUrl = (backdropPath) => {
  return `${CONFIG.BACKDROP_IMAGE_URL}${backdropPath}`;
};

const createBackdropElement = (backdropPath) => {
  const backdrop = document.createElement('div');
  backdrop.classList.add(CSS_CLASSES.DETAILS_BACKDROP);
  backdrop.style.backgroundImage = `url(${getBackdropUrl(backdropPath)})`;
  return backdrop;
};

const displayBackdrop = (containerSelector, backdropPath) => {
  if (!backdropPath) {
    console.warn('‚ö†Ô∏è Backdrop image tidak tersedia');
    return;
  }
  const container = document.querySelector(containerSelector);
  if (!container) {
    console.error(`‚ùå Container ${containerSelector} tidak ditemukan!`);
    return;
  }
  const backdrop = createBackdropElement(backdropPath);
  container.appendChild(backdrop);
  console.log('‚úÖ Backdrop berhasil ditampilkan');
};

// ============================================
// ‚úÖ END OF PART 2
// ‚¨áÔ∏è Lanjutkan dengan PART 3
// ============================================

// ============================================
// üì¶ PART 3 of 4: HTML BUILDERS + RENDER FUNCTIONS
// ============================================

// ============================================
// HTML BUILDERS - MOVIE
// ============================================
const buildMoviePosterHTML = (movie) => {
  const imageUrl = getImageUrl(movie.poster_path);
  return `<img src="${imageUrl}" class="card-img-top" alt="${movie.title}" />`;
};

const buildGenresListHTML = (genres) => {
  if (!genres || genres.length === 0) {
    return '<li>No genres available</li>';
  }
  return genres.map((genre) => `<li>${genre.name}</li>`).join('');
};

const buildProductionCompaniesHTML = (companies) => {
  if (!companies || companies.length === 0) {
    return '<span>No information available</span>';
  }
  return companies.map((company) => `<span>${company.name}</span>`).join(', ');
};

const buildMovieDetailsTopHTML = (movie) => {
  const posterHTML = buildMoviePosterHTML(movie);
  const genresHTML = buildGenresListHTML(movie.genres);
  const rating = movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A';
  const overview = movie.overview || 'No overview available.';
  const homepage = movie.homepage || '#';
  return `
    <div class="details-top">
      <div>${posterHTML}</div>
      <div>
        <h2>${movie.title}</h2>
        <p><i class="fas fa-star text-primary"></i> ${rating} / 10</p>
        <p class="text-muted">Release Date: ${movie.release_date || 'N/A'}</p>
        <p>${overview}</p>
        <h5>Genres</h5>
        <ul class="list-group">${genresHTML}</ul>
        <a href="${homepage}" target="_blank" class="btn">Visit Movie Homepage</a>
      </div>
    </div>
  `;
};

const buildMovieDetailsBottomHTML = (movie) => {
  const budget = formatNumberWithCommas(movie.budget);
  const revenue = formatNumberWithCommas(movie.revenue);
  const runtime = movie.runtime || 'N/A';
  const status = movie.status || 'N/A';
  const companiesHTML = buildProductionCompaniesHTML(movie.production_companies);
  return `
    <div class="details-bottom">
      <h2>Movie Info</h2>
      <ul>
        <li><span class="text-secondary">Budget:</span> $${budget}</li>
        <li><span class="text-secondary">Revenue:</span> $${revenue}</li>
        <li><span class="text-secondary">Runtime:</span> ${runtime} minutes</li>
        <li><span class="text-secondary">Status:</span> ${status}</li>
      </ul>
      <h4>Production Companies</h4>
      <div class="list-group">${companiesHTML}</div>
    </div>
  `;
};

// ============================================
// HTML BUILDERS - TV SHOW
// ============================================
const buildShowPosterHTML = (show) => {
  const imageUrl = getImageUrl(show.poster_path);
  return `<img src="${imageUrl}" class="card-img-top" alt="${show.name}" />`;
};

const buildShowDetailsTopHTML = (show) => {
  const posterHTML = buildShowPosterHTML(show);
  const genresHTML = buildGenresListHTML(show.genres);
  const rating = show.vote_average ? show.vote_average.toFixed(1) : 'N/A';
  const overview = show.overview || 'No overview available.';
  const homepage = show.homepage || '#';
  return `
    <div class="details-top">
      <div>${posterHTML}</div>
      <div>
        <h2>${show.name}</h2>
        <p><i class="fas fa-star text-primary"></i> ${rating} / 10</p>
        <p class="text-muted">Last Air Date: ${show.last_air_date || 'N/A'}</p>
        <p>${overview}</p>
        <h5>Genres</h5>
        <ul class="list-group">${genresHTML}</ul>
        <a href="${homepage}" target="_blank" class="btn">Visit Show Homepage</a>
      </div>
    </div>
  `;
};

const buildShowDetailsBottomHTML = (show) => {
  const numberOfEpisodes = show.number_of_episodes || 'N/A';
  const lastEpisodeName = show.last_episode_to_air?.name || 'N/A';
  const status = show.status || 'N/A';
  const companiesHTML = buildProductionCompaniesHTML(show.production_companies);
  return `
    <div class="details-bottom">
      <h2>Show Info</h2>
      <ul>
        <li><span class="text-secondary">Number of Episodes:</span> ${numberOfEpisodes}</li>
        <li><span class="text-secondary">Last Episode To Air:</span> ${lastEpisodeName}</li>
        <li><span class="text-secondary">Status:</span> ${status}</li>
      </ul>
      <h4>Production Companies</h4>
      <div class="list-group">${companiesHTML}</div>
    </div>
  `;
};

// üÜïüîç SEARCH HEADING HTML
const createSearchHeading = (totalResults, searchTerm, currentPage, totalPages) => {
  return `
    <h2>${totalResults} of ${totalResults} Results for "${searchTerm}"</h2>
    <p class="text-muted">Page ${currentPage} of ${totalPages}</p>
  `;
};

// üÜïüÜïüî¢ PAGINATION HTML BUILDER
const buildPaginationHTML = (currentPage, totalPages) => {
  const isPrevDisabled = currentPage === 1;
  const isNextDisabled = currentPage >= totalPages;

  return `
    <div class="pagination">
      <button class="btn btn-primary" id="prev" ${isPrevDisabled ? 'disabled' : ''}>Prev</button>
      <button class="btn btn-primary" id="next" ${isNextDisabled ? 'disabled' : ''}>Next</button>
      <div class="page-counter">Page ${currentPage} of ${totalPages}</div>
    </div>
  `;
};

// ============================================
// ERROR DISPLAY
// ============================================
const showMovieDetailsError = (message) => {
  const container = document.querySelector(SELECTORS.MOVIE_DETAILS_CONTAINER);
  if (!container) {
    console.error('‚ùå Container movie details tidak ditemukan!');
    return;
  }
  container.innerHTML = `
    <div class="alert alert-error">
      <p>‚ö†Ô∏è ${message}</p>
      <a href="index.html" class="btn">‚Üê Back to Movies</a>
    </div>
  `;
};

const showShowDetailsError = (message) => {
  const container = document.querySelector(SELECTORS.SHOW_DETAILS_CONTAINER);
  if (!container) {
    console.error('‚ùå Container show details tidak ditemukan!');
    return;
  }
  container.innerHTML = `
    <div class="alert alert-error">
      <p>‚ö†Ô∏è ${message}</p>
      <a href="shows.html" class="btn">‚Üê Back to TV Shows</a>
    </div>
  `;
};

// üÜïüîç NO RESULTS MESSAGE
const showNoResultsMessage = (searchTerm) => {
  const container = document.querySelector(SEARCH_SELECTORS.SEARCH_RESULTS);
  if (!container) {
    console.error('‚ùå Search results container tidak ditemukan!');
    return;
  }
  container.innerHTML = `
    <div class="alert ${ALERT_TYPES.INFO}">
      <p>üîç Tidak ada hasil untuk "${searchTerm}"</p>
      <p>Coba gunakan kata kunci lain atau periksa ejaan Anda.</p>
    </div>
  `;
};

// ============================================
// RENDER FUNCTIONS
// ============================================
const renderMovieList = (movies) => {
  const container = document.querySelector(SELECTORS.POPULAR_MOVIES);
  if (!container) {
    console.error('‚ùå Container #popular-movies tidak ditemukan!');
    return;
  }
  movies.forEach((movie) => {
    const cardElement = createMovieCard(movie);
    container.appendChild(cardElement);
  });
};

const renderShowList = (shows) => {
  const container = document.querySelector(SELECTORS.POPULAR_SHOWS);
  if (!container) {
    console.error('‚ùå Container #popular-shows tidak ditemukan!');
    return;
  }
  shows.forEach((show) => {
    const cardElement = createShowCard(show);
    container.appendChild(cardElement);
  });
};

const renderMovieDetails = (movie) => {
  const container = document.querySelector(SELECTORS.MOVIE_DETAILS_CONTAINER);
  if (!container) {
    console.error('‚ùå Container #movie-details tidak ditemukan!');
    return;
  }
  const detailsWrapper = document.createElement('div');
  const topHTML = buildMovieDetailsTopHTML(movie);
  const bottomHTML = buildMovieDetailsBottomHTML(movie);
  detailsWrapper.innerHTML = `${topHTML}${bottomHTML}`;
  container.appendChild(detailsWrapper);
};

const renderShowDetails = (show) => {
  const container = document.querySelector(SELECTORS.SHOW_DETAILS_CONTAINER);
  if (!container) {
    console.error('‚ùå Container #show-details tidak ditemukan!');
    return;
  }
  const detailsWrapper = document.createElement('div');
  const topHTML = buildShowDetailsTopHTML(show);
  const bottomHTML = buildShowDetailsBottomHTML(show);
  detailsWrapper.innerHTML = `${topHTML}${bottomHTML}`;
  container.appendChild(detailsWrapper);
};

const renderSwiperSlides = (movies) => {
  const wrapper = document.querySelector(SELECTORS.SWIPER_WRAPPER);
  if (!wrapper) {
    console.error('‚ùå Swiper wrapper tidak ditemukan!');
    return;
  }
  wrapper.innerHTML = '';
  movies.forEach((movie) => {
    const slideElement = createSwiperSlide(movie);
    wrapper.appendChild(slideElement);
  });
  console.log(`‚úÖ ${movies.length} slides berhasil di-render`);
};

// üÜïüîç SEARCH RESULTS RENDER
const renderSearchResults = (results, searchType) => {
  const container = document.querySelector(SEARCH_SELECTORS.SEARCH_RESULTS);
  if (!container) {
    console.error('‚ùå Search results container tidak ditemukan!');
    return;
  }
  container.innerHTML = '';
  results.forEach((item) => {
    const cardElement = searchType === SEARCH_CONFIG.SEARCH_TYPES.MOVIE
      ? createSearchMovieCard(item)
      : createSearchShowCard(item);
    container.appendChild(cardElement);
  });
  console.log(`‚úÖ ${results.length} hasil di-render`);
};

const updateSearchHeading = (searchData, searchTerm) => {
  const headingContainer = document.querySelector(SEARCH_SELECTORS.SEARCH_HEADING);
  if (!headingContainer) {
    console.warn('‚ö†Ô∏è Search heading container tidak ditemukan');
    return;
  }
  const totalResults = searchData.total_results || 0;
  const currentPage = searchData.page || 1;
  const totalPages = searchData.total_pages || 1;
  headingContainer.innerHTML = createSearchHeading(totalResults, searchTerm, currentPage, totalPages);
};

// üÜïüÜïüî¢ RENDER PAGINATION
const renderPagination = (currentPage, totalPages) => {
  const container = document.querySelector(PAGINATION_SELECTORS.CONTAINER);
  
  if (!container) {
    console.error('‚ùå Pagination container tidak ditemukan!');
    return;
  }
  
  // Clear isi lama
  container.innerHTML = '';
  
  // Jika hanya 1 halaman, tidak perlu pagination
  if (totalPages <= 1) {
    console.log('‚ÑπÔ∏è Hanya 1 halaman, pagination tidak ditampilkan');
    return;
  }
  
  // Render HTML pagination
  const paginationHTML = buildPaginationHTML(currentPage, totalPages);
  container.innerHTML = paginationHTML;
  
  console.log(`‚úÖ Pagination rendered: Page ${currentPage} of ${totalPages}`);
  
  // üÜïüÜï Auto attach listeners
  attachPaginationListeners();
};

// üÜïüÜïüî¢ PAGINATION EVENT HANDLERS
const handlePrevPageClick = async () => {
  console.log('‚¨ÖÔ∏è Tombol Prev diklik');
  
  if (SEARCH_STATE.currentPage <= 1) {
    console.warn('‚ö†Ô∏è Sudah di halaman pertama');
    return;
  }
  
  SEARCH_STATE.currentPage--;
  console.log(`üìÑ Pindah ke halaman: ${SEARCH_STATE.currentPage}`);
  
  // üÜïüÜï Reload search results
  await reloadSearchResults();
};

const handleNextPageClick = async () => {
  console.log('‚û°Ô∏è Tombol Next diklik');
  
  if (SEARCH_STATE.currentPage >= SEARCH_STATE.totalPages) {
    console.warn('‚ö†Ô∏è Sudah di halaman terakhir');
    return;
  }
  
  SEARCH_STATE.currentPage++;
  console.log(`üìÑ Pindah ke halaman: ${SEARCH_STATE.currentPage}`);
  
  // üÜïüÜï Reload search results
  await reloadSearchResults();
};

// üÜïüÜïüî¢ ATTACH EVENT LISTENERS
const attachPaginationListeners = () => {
  const prevBtn = document.querySelector(PAGINATION_SELECTORS.PREV_BUTTON);
  const nextBtn = document.querySelector(PAGINATION_SELECTORS.NEXT_BUTTON);
  
  if (prevBtn) {
    prevBtn.addEventListener('click', handlePrevPageClick);
    console.log('‚úÖ Event listener Prev attached');
  }
  
  if (nextBtn) {
    nextBtn.addEventListener('click', handleNextPageClick);
    console.log('‚úÖ Event listener Next attached');
  }
};

// ============================================
// ‚úÖ END OF PART 3
// ‚¨áÔ∏è Lanjutkan dengan PART 4 (TERAKHIR)
// ============================================

// ============================================
// üì¶ PART 4 of 4: CONTROLLERS + ROUTING + INITIALIZATION (FINAL)
// ============================================

// ============================================
// SWIPER INITIALIZATION
// ============================================
const initializeSwiperSlider = () => {
  const container = document.querySelector(SELECTORS.SWIPER_CONTAINER);
  if (!container) {
    console.error('‚ùå Swiper container tidak ditemukan!');
    return null;
  }
  if (typeof Swiper === 'undefined') {
    console.error('‚ùå Swiper library belum dimuat!');
    return null;
  }
  const swiperInstance = new Swiper(SELECTORS.SWIPER_CONTAINER, SWIPER_CONFIG);
  console.log('‚úÖ Swiper slider berhasil diinisialisasi');
  return swiperInstance;
};

// ============================================
// DISPLAY CONTROLLERS
// ============================================
const displayPopularMovies = async () => {
  const movies = await fetchPopularMovies();
  if (!movies || movies.length === 0) {
    console.error('‚ùå Gagal mengambil data movies');
    return;
  }
  renderMovieList(movies);
};

const displayPopularShows = async () => {
  const shows = await fetchPopularShows();
  if (!shows || shows.length === 0) {
    console.error('‚ùå Gagal mengambil data TV shows');
    return;
  }
  renderShowList(shows);
};

const displayMovieDetails = async () => {
  const movieId = getMovieIdFromUrl();
  if (!movieId) {
    console.error('‚ùå Movie ID tidak ditemukan di URL!');
    showMovieDetailsError('Movie ID tidak ditemukan!');
    return;
  }
  const movie = await fetchMovieDetail(movieId);
  if (!movie || !movie.id) {
    console.error('‚ùå Data movie tidak ditemukan!');
    showMovieDetailsError('Data movie tidak ditemukan.');
    return;
  }
  displayBackdrop(SELECTORS.MOVIE_DETAILS_CONTAINER, movie.backdrop_path);
  console.log('‚úÖ Movie details berhasil dimuat:', movie.title);
  renderMovieDetails(movie);
};

const displayShowDetails = async () => {
  const showId = getShowIdFromUrl();
  if (!showId) {
    console.error('‚ùå Show ID tidak ditemukan di URL!');
    showShowDetailsError('Show ID tidak ditemukan!');
    return;
  }
  const show = await fetchShowDetail(showId);
  if (!show || !show.id) {
    console.error('‚ùå Data show tidak ditemukan!');
    showShowDetailsError('Data show tidak ditemukan.');
    return;
  }
  displayBackdrop(SELECTORS.SHOW_DETAILS_CONTAINER, show.backdrop_path);
  console.log('‚úÖ Show details berhasil dimuat:', show.name);
  renderShowDetails(show);
};

const displaySwiperSlider = async () => {
  console.log('üé¨ Memuat Swiper Slider...');
  const movies = await fetchNowPlayingMovies();
  if (!movies || movies.length === 0) {
    console.error('‚ùå Gagal mengambil data Now Playing movies');
    return;
  }
  renderSwiperSlides(movies);
  initializeSwiperSlider();
};

// üÜïüÜïüî¢ RELOAD SEARCH RESULTS (untuk pagination)
const reloadSearchResults = async () => {
  console.log(`üîÑ Reload hasil - Page ${SEARCH_STATE.currentPage}`);
  
  const searchData = await searchMoviesOrShows(
    SEARCH_STATE.searchTerm,
    SEARCH_STATE.searchType,
    SEARCH_STATE.currentPage
  );
  
  if (!searchData) {
    console.error('‚ùå Gagal reload data');
    return;
  }
  
  const results = searchData.results || [];
  
  // Update state
  SEARCH_STATE.totalPages = searchData.total_pages || 1;
  SEARCH_STATE.totalResults = searchData.total_results || 0;
  
  // Render ulang
  renderSearchResults(results, SEARCH_STATE.searchType);
  updateSearchHeading(searchData, SEARCH_STATE.searchTerm);
  renderPagination(SEARCH_STATE.currentPage, SEARCH_STATE.totalPages);
  
  // Scroll ke atas
  window.scrollTo({ top: 0, behavior: 'smooth' });
  
  console.log(`‚úÖ Reload selesai: ${results.length} hasil`);
};

// üÜïüîç SEARCH CONTROLLER (üÜïüÜï UPDATED dengan Pagination)
const performSearch = async () => {
  console.log('üîç Memulai pencarian...');
  
  // 1. Ambil parameter dari URL
  const searchTerm = getSearchTermFromUrl();
  const searchType = getSearchTypeFromUrl();
  const currentPage = getPageFromUrl();
  
  // üÜïüÜï 2. Update state
  SEARCH_STATE.searchTerm = searchTerm;
  SEARCH_STATE.searchType = searchType;
  SEARCH_STATE.currentPage = currentPage;
  
  // 3. Validasi search term
  const validation = validateSearchTerm(searchTerm);
  if (!validation.isValid) {
    console.error('‚ùå Validasi gagal:', validation.message);
    showErrorAlert(validation.message);
    return;
  }
  
  // 4. Fetch data
  console.log(`üì° Mencari ${searchType}: "${searchTerm}" (Page ${currentPage})`);
  const searchData = await searchMoviesOrShows(searchTerm, searchType, currentPage);
  if (!searchData) {
    console.error('‚ùå Gagal mendapatkan data pencarian');
    return;
  }
  
  // 5. Render hasil
  const results = searchData.results || [];
  if (results.length === 0) {
    showNoResultsMessage(searchTerm);
    showInfoAlert(`Tidak ada hasil untuk "${searchTerm}"`);
    return;
  }
  
  // üÜïüÜï 6. Update state
  SEARCH_STATE.totalPages = searchData.total_pages || 1;
  SEARCH_STATE.totalResults = searchData.total_results || 0;
  
  // 7. Update heading
  updateSearchHeading(searchData, searchTerm);
  
  // 8. Render cards
  renderSearchResults(results, searchType);
  
  // üÜïüÜï 9. Render pagination
  renderPagination(SEARCH_STATE.currentPage, SEARCH_STATE.totalPages);
  
  // 10. Success message
  showSuccessAlert(`Ditemukan ${results.length} hasil`);
  console.log(`‚úÖ Pencarian selesai: ${results.length} hasil`);
};

// üÜïüìù SEARCH FORM HANDLING
const handleSearchFormSubmit = (event) => {
  event.preventDefault();
  
  const searchInput = document.querySelector(SEARCH_SELECTORS.SEARCH_INPUT);
  const searchTypeRadio = document.querySelector(`${SEARCH_SELECTORS.SEARCH_TYPE_RADIO}:checked`);
  
  if (!searchInput || !searchTypeRadio) {
    console.error('‚ùå Form elements tidak ditemukan!');
    showErrorAlert('Form pencarian tidak valid!');
    return;
  }
  
  const searchTerm = searchInput.value.trim();
  const searchType = searchTypeRadio.value;
  
  // Validasi
  const validation = validateSearchTerm(searchTerm);
  if (!validation.isValid) {
    showErrorAlert(validation.message);
    return;
  }
  
  // Redirect ke halaman search dengan query params
  const searchUrl = `search.html?type=${searchType}&search-term=${encodeURIComponent(searchTerm)}`;
  window.location.href = searchUrl;
};

const initializeSearchForm = () => {
  const searchForm = document.querySelector(SEARCH_SELECTORS.SEARCH_FORM);
  if (!searchForm) {
    console.warn('‚ö†Ô∏è Search form tidak ditemukan di halaman ini');
    return;
  }
  searchForm.addEventListener('submit', handleSearchFormSubmit);
  console.log('‚úÖ Search form event listener initialized');
};

// ============================================
// NAVIGATION FUNCTIONS
// ============================================
const highlightActiveLink = () => {
  const currentPage = getCurrentPage();
  const links = document.querySelectorAll(SELECTORS.NAV_LINKS);
  links.forEach((link) => {
    const linkPath = link.getAttribute('href');
    if (linkPath === currentPage) {
      link.classList.add(CSS_CLASSES.ACTIVE_LINK);
    }
  });
};

// ============================================
// ROUTING
// ============================================
const routePage = () => {
  const currentPage = getCurrentPage();
  
  switch (currentPage) {
    case PAGES.HOME:
    case PAGES.INDEX:
      console.log('üè† Halaman Home - Popular Movies + üé¨ Swiper');
      displaySwiperSlider();
      displayPopularMovies();
      break;
      
    case PAGES.SHOWS:
      console.log('üì∫ Halaman TV Shows');
      displayPopularShows();
      break;
      
    case PAGES.MOVIE_DETAILS:
      console.log('üé¨ Halaman Movie Details');
      displayMovieDetails();
      break;
      
    case PAGES.TV_DETAILS:
      console.log('üì∫ Halaman TV Details');
      displayShowDetails();
      break;
      
    case PAGES.SEARCH:
      console.log('üîç Halaman Search');
      performSearch();  // üÜïüÜï Sudah include pagination
      break;
      
    default:
      console.log('üìÑ Halaman tidak dikenali');
  }
};

// ============================================
// INITIALIZATION
// ============================================
const initializeApp = () => {
  console.log('üöÄ Aplikasi dimulai...');
  routePage();
  highlightActiveLink();
  initializeSearchForm();
};

// ============================================
// EVENT LISTENERS
// ============================================
document.addEventListener('DOMContentLoaded', initializeApp);

// ============================================
// ‚úÖ‚úÖ‚úÖ END OF FULL CODE - PAGINATION COMPLETE! ‚úÖ‚úÖ‚úÖ
// ============================================

/*
üÜïüÜï FITUR PAGINATION YANG DITAMBAHKAN:

PART 1:
‚úÖ PAGINATION_SELECTORS - Selector untuk tombol pagination
‚úÖ SEARCH_STATE - State management untuk pagination

PART 3:
‚úÖ buildPaginationHTML() - Generate HTML pagination
‚úÖ renderPagination() - Render pagination ke DOM
‚úÖ handlePrevPageClick() - Handler tombol Previous
‚úÖ handleNextPageClick() - Handler tombol Next
‚úÖ attachPaginationListeners() - Attach event listeners

PART 4:
‚úÖ reloadSearchResults() - Reload data saat pagination
‚úÖ performSearch() - Updated dengan render pagination

CARA PAKAI:
1. Buka search.html
2. Cari kata kunci (min 3 karakter)
3. Klik Next/Prev untuk navigasi halaman
4. Tombol auto disabled di halaman pertama/terakhir
5. Data auto reload + scroll to top
*/
```

</details>
