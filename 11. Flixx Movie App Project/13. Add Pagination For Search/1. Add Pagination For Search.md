# ğŸ¬ Dokumentasi Pagination - Movie Search App

> **ğŸ“ Catatan Penting**: Dokumentasi ini adalah catatan pembelajaran pribadi untuk memahami cara membuat fitur pagination pada aplikasi pencarian film menggunakan JavaScript.

---

## ğŸ“‘ Daftar Isi

- [Pengenalan](#pengenalan)
- [Persiapan Global State](#persiapan-global-state)
- [Menyimpan Data Pagination ke Global State](#menyimpan-data-pagination-ke-global-state)
- [Menampilkan Heading Hasil Pencarian](#menampilkan-heading-hasil-pencarian)
- [Debugging Error Total Results](#debugging-error-total-results)
- [Membuat Fungsi Display Pagination](#membuat-fungsi-display-pagination)
- [Debugging Error Total Pages](#debugging-error-total-pages)
- [Disable Tombol Prev dan Next](#disable-tombol-prev-dan-next)
- [Menambahkan Page Parameter ke API](#menambahkan-page-parameter-ke-api)
- [Event Listener Tombol Next](#event-listener-tombol-next)
- [Membersihkan Hasil Sebelumnya](#membersihkan-hasil-sebelumnya)
- [Event Listener Tombol Previous](#event-listener-tombol-previous)
- [Testing Final](#testing-final)
- [Kode Lengkap](#kode-lengkap)

---

<a name="pengenalan"></a>
## ğŸ¯ Pengenalan

Dalam tutorial ini, kita akan belajar cara membuat fitur **pagination** (halaman bertingkat) untuk hasil pencarian film. Pagination sangat penting karena API biasanya mengembalikan banyak hasil (bisa ratusan!), dan kita tidak bisa menampilkan semuanya sekaligus.

**ğŸ“ Apa yang akan kita pelajari:**
- âœ… Menampilkan informasi jumlah hasil (contoh: "20 of 162 results for orphan")
- âœ… Membuat tombol Next dan Previous yang berfungsi
- âœ… Menonaktifkan tombol jika sudah di halaman pertama/terakhir
- âœ… Mengganti hasil pencarian saat berpindah halaman
- âœ… Debugging error yang muncul saat development

---

<a name="persiapan-global-state"></a>
## ğŸ—„ï¸ Persiapan Global State

Sebelum membuat pagination, kita perlu menambahkan properti `totalResults` ke dalam global state untuk menyimpan total semua hasil pencarian.

### ğŸ“ Kode Sebelum:

```javascript
const global = {
  currentPage: window.location.pathname,
  search: {
    term: '',
    type: '',
    page: 1,
    totalPages: 1,
  },
  api: {
    apiKey: '',
    apiUrl: 'https://api.themoviedb.org/3/',
  },
};
```

### âœ¨ Kode Setelah:

```javascript
const global = {
  currentPage: window.location.pathname,
  search: {
    term: '',
    type: '',
    page: 1,
    totalPages: 1,
    totalResults: 0, // ğŸ†• TAMBAHAN BARU!
  },
  api: {
    apiKey: '',
    apiUrl: 'https://api.themoviedb.org/3/',
  },
};
```

**ğŸ’¡ Penjelasan:**
- `totalResults: 0` â†’ Menyimpan total semua hasil pencarian dari API
- Kita set default ke `0` karena belum ada pencarian yang dilakukan
- Properti ini akan diupdate setiap kali kita melakukan pencarian

---

<a name="menyimpan-data-pagination-ke-global-state"></a>
## ğŸ’¾ Menyimpan Data Pagination ke Global State

API The Movie Database mengembalikan beberapa informasi penting untuk pagination:
- `page` - Halaman saat ini
- `total_pages` - Total semua halaman
- `total_results` - Total semua hasil pencarian

Kita perlu menyimpan semua data ini ke global state.

### ğŸ“ Kode Sebelum (fungsi `search()`):

```javascript
async function search() {
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);

  global.search.type = urlParams.get('type');
  global.search.term = urlParams.get('search-term');

  if (global.search.term !== '' && global.search.term !== null) {
    const { results, total_pages, page } = await searchAPIData();
    
    if (results.length === 0) {
      showAlert('No results found');
      return;
    }

    displaySearchResults(results);
    document.querySelector('#search-term').value = '';
  } else {
    showAlert('Please enter a search term');
  }
}
```

### âœ¨ Kode Setelah:

```javascript
async function search() {
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);

  global.search.type = urlParams.get('type');
  global.search.term = urlParams.get('search-term');

  if (global.search.term !== '' && global.search.term !== null) {
    // ğŸ”„ Destructure total_results juga dari API
    const { results, total_pages, page, total_results } = await searchAPIData();
    
    // ğŸ†• SIMPAN KE GLOBAL STATE
    global.search.page = page;
    global.search.totalPages = total_pages; // âš ï¸ Pakai camelCase!
    global.search.totalResults = total_results; // âš ï¸ Pakai camelCase!

    if (results.length === 0) {
      showAlert('No results found');
      return;
    }

    displaySearchResults(results);
    document.querySelector('#search-term').value = '';
  } else {
    showAlert('Please enter a search term');
  }
}
```

**âš ï¸ Catatan Penting tentang Naming Convention:**
- **Dari API:** `total_pages` (snake_case dengan underscore)
- **Kita simpan sebagai:** `totalPages` (camelCase tanpa underscore)
- **Alasan:** Ini adalah konvensi JavaScript yang lebih umum dan konsisten

**ğŸ’¡ Penjelasan Kode:**
1. Kita menambahkan `total_results` di destructuring
2. Menyimpan `page` dari API ke `global.search.page`
3. Menyimpan `total_pages` ke `global.search.totalPages` (ubah ke camelCase)
4. Menyimpan `total_results` ke `global.search.totalResults` (ubah ke camelCase)

---

<a name="menampilkan-heading-hasil-pencarian"></a>
## ğŸ“Š Menampilkan Heading Hasil Pencarian

Sekarang kita akan menampilkan heading yang menunjukkan berapa banyak hasil yang ditemukan. Contohnya: **"20 of 162 Results for orphan"**

### ğŸ” Struktur HTML

Di file `search.html`, sudah ada elemen dengan ID `search-results-heading`:

```html
<section id="search-results-wrapper" class="container">
  <heading id="search-results-heading"></heading> <!-- ğŸ‘ˆ Target kita -->
  <div id="search-results" class="grid"></div>
  <div id="pagination"></div>
</section>
```

### âœ¨ Kode yang Ditambahkan (dalam fungsi `displaySearchResults`):

Tambahkan kode ini **di dalam loop forEach**, jadi heading akan dibuat bersamaan dengan hasil pencarian:

```javascript
function displaySearchResults(results) {
  results.forEach((result) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
      <!-- ... kode card ... -->
    `;

    // ğŸ†• TAMBAHKAN HEADING DI SINI (dalam loop)
    document.querySelector('#search-results-heading').innerHTML = `
      <h2>${results.length} of ${global.search.totalResults} Results for ${global.search.term}</h2>
    `;

    document.querySelector('#search-results').appendChild(div);
  });
}
```

**ğŸ’¡ Penjelasan Komponen:**

1. **`results.length`** 
   - Jumlah hasil di halaman saat ini
   - Biasanya selalu 20 (karena API memberikan 20 per halaman)

2. **`global.search.totalResults`** 
   - Total semua hasil dari semua halaman
   - Contoh: 162, 500, dst

3. **`global.search.term`** 
   - Kata kunci yang dicari user
   - Contoh: "orphan", "batman", dst

**ğŸ“Œ Contoh Output:**
```
20 of 162 Results for orphan
```

---

<a name="debugging-error-total-results"></a>
## ğŸ› Debugging Error: Total Results Undefined

Setelah menjalankan kode di atas, kita mendapat error: **"total_results is not defined"**

### âŒ Masalah:

Kita menggunakan `total_results` (dengan underscore) padahal dari API memang seperti itu, tapi kita lupa menambahkannya di destructuring!

### ğŸ”§ Solusi:

Kembali ke fungsi `search()` dan pastikan kita sudah menambahkan `total_results`:

```javascript
// âœ… PASTIKAN total_results ada di sini!
const { results, total_pages, page, total_results } = await searchAPIData();
```

**ğŸ‰ Hasil Setelah Fix:**
```
20 of 162 results for orphan
```

Kalau kita search "Good Fellas", hasilnya:
```
2 of 2 results
```

**ğŸ’¡ Pelajaran:**
- Selalu periksa console untuk error
- Error message biasanya memberi tahu baris kode yang bermasalah
- Dalam kasus ini, error di baris 266 menunjukkan kita lupa mendeklarasikan `total_results`

---

<a name="membuat-fungsi-display-pagination"></a>
## ğŸ¨ Membuat Fungsi Display Pagination

Sekarang kita akan membuat fungsi untuk menampilkan tombol pagination (Prev, Next, dan info halaman). Kita akan membuat elemen ini secara dinamis dengan JavaScript.

### ğŸ¯ Struktur HTML yang Akan Dibuat

```html
<div class="pagination">
  <button class="btn btn-primary" id="prev">Prev</button>
  <button class="btn btn-primary" id="next">Next</button>
  <div class="page-counter">Page 1 of 9</div>
</div>
```

### ğŸ’» Kode Fungsi `displayPagination()`:

```javascript
// Create & Display Pagination For Search
function displayPagination() {
  // 1ï¸âƒ£ Buat element div
  const div = document.createElement('div');
  div.classList.add('pagination');
  
  // 2ï¸âƒ£ Isi dengan HTML tombol dan info halaman
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  // 3ï¸âƒ£ Masukkan ke DOM
  document.querySelector('#pagination').appendChild(div);
}
```

**ğŸ’¡ Penjelasan Step by Step:**

1. **Membuat Element Div** 
   - `document.createElement('div')` â†’ Membuat container
   - `div.classList.add('pagination')` â†’ Tambah class CSS

2. **Mengisi HTML dengan Template String**
   - Tombol Prev dengan ID `prev`
   - Tombol Next dengan ID `next`
   - Info halaman menggunakan data dari `global.search.page` dan `global.search.totalPages`

3. **Append ke DOM**
   - Mencari element dengan ID `pagination`
   - Memasukkan div yang sudah dibuat

### ğŸ“ Memanggil Fungsi

Panggil `displayPagination()` di akhir fungsi `displaySearchResults()`:

```javascript
function displaySearchResults(results) {
  results.forEach((result) => {
    // ... kode menampilkan hasil
  });

  // ğŸ†• Panggil fungsi pagination di sini!
  displayPagination();
}
```

---

<a name="debugging-error-total-pages"></a>
## ğŸ› Debugging Error: Total Pages Undefined

Setelah menjalankan kode, pagination muncul tapi menampilkan: **"Page 1 of undefined"**

### âŒ Masalah:

Di fungsi `displayPagination()`, kita menggunakan `global.search.totalPages` tapi di global state kita mendefinisikannya dengan cara yang berbeda.

### ğŸ” Analisis Error:

**Dari API:**
```javascript
// API mengembalikan: total_pages (dengan underscore)
const { results, total_pages } = await searchAPIData();
```

**Di Global State:**
```javascript
// Kita simpan sebagai: totalPages (camelCase)
global.search.totalPages = total_pages;
```

**Di Template String:**
```javascript
// Tapi kita pakai: total_pages (salah!)
div.innerHTML = `
  <div class="page-counter">Page ${global.search.page} of ${global.search.total_pages}</div>
`;
```

### ğŸ”§ Solusi:

Ubah `total_pages` menjadi `totalPages` di template string:

```javascript
div.innerHTML = `
  <button class="btn btn-primary" id="prev">Prev</button>
  <button class="btn btn-primary" id="next">Next</button>
  <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  <!--                                                        ğŸ‘† Ubah ini! -->
`;
```

**ğŸ‰ Hasil Setelah Fix:**
```
Page 1 of 9
```

**ğŸ’¡ Pelajaran:**
- Konsisten dalam penamaan variabel
- API menggunakan snake_case (`total_pages`)
- JavaScript convention menggunakan camelCase (`totalPages`)
- Kita harus konsisten menggunakan camelCase di seluruh kode JavaScript kita

---

<a name="disable-tombol-prev-dan-next"></a>
## ğŸš« Disable Tombol Prev dan Next

Kita perlu membuat logic untuk menonaktifkan tombol:
- **Tombol Prev** â†’ Disabled jika di halaman pertama (page = 1)
- **Tombol Next** â†’ Disabled jika di halaman terakhir (page = total pages)

### âœ¨ Tambahkan Kode Ini di Fungsi `displayPagination()`:

```javascript
function displayPagination() {
  const div = document.createElement('div');
  div.classList.add('pagination');
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  document.querySelector('#pagination').appendChild(div);

  // ğŸ†• DISABLE PREV BUTTON IF ON FIRST PAGE
  if (global.search.page === 1) {
    document.querySelector('#prev').disabled = true;
  }

  // ğŸ†• DISABLE NEXT BUTTON IF ON LAST PAGE
  if (global.search.page === global.search.totalPages) {
    document.querySelector('#next').disabled = true;
  }
}
```

**ğŸ’¡ Penjelasan Logic:**

### 1ï¸âƒ£ Disable Tombol Previous

```javascript
if (global.search.page === 1) {
  document.querySelector('#prev').disabled = true;
}
```

- **Kondisi:** Jika halaman saat ini = 1 (halaman pertama)
- **Aksi:** Set property `disabled` menjadi `true`
- **Hasil:** Tombol jadi abu-abu dan tidak bisa diklik

### 2ï¸âƒ£ Disable Tombol Next

```javascript
if (global.search.page === global.search.totalPages) {
  document.querySelector('#next').disabled = true;
}
```

- **Kondisi:** Jika halaman saat ini = total halaman (halaman terakhir)
- **Aksi:** Set property `disabled` menjadi `true`
- **Hasil:** Tombol jadi abu-abu dan tidak bisa diklik

**ğŸ¨ Tampilan Visual:**
- Tombol disabled â†’ Warna abu-abu
- Saat hover â†’ Cursor berubah jadi simbol "not-allowed" (ğŸš«)

---

<a name="menambahkan-page-parameter-ke-api"></a>
## ğŸ”Œ Menambahkan Page Parameter ke API

Agar API bisa mengembalikan halaman yang berbeda, kita perlu menambahkan parameter `page` ke URL request.

### ğŸ“ Kode Sebelum:

```javascript
async function searchAPIData() {
  const API_KEY = global.api.apiKey;
  const API_URL = global.api.apiUrl;

  showSpinner();

  const response = await fetch(
    `${API_URL}search/${global.search.type}?api_key=${API_KEY}&language=en-US&query=${global.search.term}`
  );

  const data = await response.json();
  hideSpinner();

  return data;
}
```

### âœ¨ Kode Setelah:

```javascript
async function searchAPIData() {
  const API_KEY = global.api.apiKey;
  const API_URL = global.api.apiUrl;

  showSpinner();

  const response = await fetch(
    `${API_URL}search/${global.search.type}?api_key=${API_KEY}&language=en-US&query=${global.search.term}&page=${global.search.page}`
    // ğŸ‘† TAMBAHKAN &page= di sini!
  );

  const data = await response.json();
  hideSpinner();

  return data;
}
```

**ğŸ’¡ Penjelasan:**

**URL Sebelum:**
```
https://api.themoviedb.org/3/search/movie?api_key=xxx&language=en-US&query=orphan
```

**URL Setelah:**
```
https://api.themoviedb.org/3/search/movie?api_key=xxx&language=en-US&query=orphan&page=1
```

**Komponen URL:**
- `&page=` â†’ Parameter untuk menentukan halaman
- `${global.search.page}` â†’ Nilai halaman dari global state (dinamis)

**ğŸ”„ Alur Kerja:**
1. Halaman pertama â†’ `page=1` â†’ Dapat hasil 1-20
2. Halaman kedua â†’ `page=2` â†’ Dapat hasil 21-40
3. Halaman ketiga â†’ `page=3` â†’ Dapat hasil 41-60
4. Dan seterusnya...

---

<a name="event-listener-tombol-next"></a>
## â­ï¸ Event Listener Tombol Next

Sekarang kita akan menambahkan fungsi pada tombol Next agar bisa berpindah ke halaman selanjutnya.

### âœ¨ Tambahkan di Fungsi `displayPagination()`:

```javascript
function displayPagination() {
  const div = document.createElement('div');
  div.classList.add('pagination');
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  document.querySelector('#pagination').appendChild(div);

  if (global.search.page === 1) {
    document.querySelector('#prev').disabled = true;
  }

  if (global.search.page === global.search.totalPages) {
    document.querySelector('#next').disabled = true;
  }

  // ğŸ†• EVENT LISTENER UNTUK NEXT
  document.querySelector('#next').addEventListener('click', async () => {
    global.search.page++; // Increment halaman
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });
}
```

**ğŸ’¡ Penjelasan Step by Step:**

### 1ï¸âƒ£ Select Tombol Next
```javascript
document.querySelector('#next')
```
- Mencari element dengan ID `next`

### 2ï¸âƒ£ Tambah Event Listener
```javascript
.addEventListener('click', async () => {
```
- Event: `click` â†’ Ketika tombol diklik
- Callback: `async` â†’ Karena kita akan melakukan request API (butuh await)

### 3ï¸âƒ£ Increment Halaman
```javascript
global.search.page++;
```
- Operator `++` â†’ Menambah nilai sebesar 1
- Contoh: Jika page = 1, setelah `++` menjadi 2

### 4ï¸âƒ£ Request ke API
```javascript
const { results, total_pages } = await searchAPIData();
```
- Memanggil fungsi `searchAPIData()` yang sudah memiliki parameter `page`
- Mendapatkan hasil untuk halaman baru

### 5ï¸âƒ£ Tampilkan Hasil Baru
```javascript
displaySearchResults(results);
```
- Memanggil fungsi untuk menampilkan hasil pencarian
- Akan menampilkan 20 hasil dari halaman baru

**ğŸ”„ Alur Lengkap Saat Klik Next:**
1. User klik tombol "Next"
2. `global.search.page` bertambah 1 (misal dari 1 ke 2)
3. Request ke API dengan `page=2`
4. API mengembalikan hasil 21-40
5. Tampilkan hasil baru di layar

---

<a name="membersihkan-hasil-sebelumnya"></a>
## ğŸ§¹ Membersihkan Hasil Sebelumnya

**âŒ Masalah yang Terjadi:**

Saat klik tombol Next:
1. Hasil lama masih tertinggal di layar
2. Pagination dibuat ulang (jadi ada 2, 3, 4 pagination!)
3. Semua hasil menumpuk

**ğŸ’¡ Solusi:**

Kita perlu membersihkan (clear) semua elemen sebelumnya sebelum menampilkan yang baru.

### âœ¨ Tambahkan di Awal Fungsi `displaySearchResults()`:

```javascript
function displaySearchResults(results) {
  // ğŸ§¹ CLEAR PREVIOUS RESULTS - Tambahkan di PALING AWAL!
  document.querySelector('#search-results').innerHTML = '';
  document.querySelector('#search-results-heading').innerHTML = '';
  document.querySelector('#pagination').innerHTML = '';

  // Sekarang baru tampilkan hasil baru
  results.forEach((result) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
      <!-- ... kode card ... -->
    `;

    document.querySelector('#search-results-heading').innerHTML = `
      <h2>${results.length} of ${global.search.totalResults} Results for ${global.search.term}</h2>
    `;

    document.querySelector('#search-results').appendChild(div);
  });

  displayPagination();
}
```

**ğŸ’¡ Penjelasan Kode Pembersihan:**

### 1ï¸âƒ£ Clear Search Results
```javascript
document.querySelector('#search-results').innerHTML = '';
```
- Mengosongkan div yang berisi card-card hasil pencarian
- Menghapus semua 20 film sebelumnya

### 2ï¸âƒ£ Clear Heading
```javascript
document.querySelector('#search-results-heading').innerHTML = '';
```
- Mengosongkan heading "20 of 162 results..."
- Akan diganti dengan heading baru

### 3ï¸âƒ£ Clear Pagination
```javascript
document.querySelector('#pagination').innerHTML = '';
```
- Mengosongkan tombol pagination
- Mencegah pagination dobel/triple

**âš ï¸ Catatan Alternatif:**

Sebenarnya kita bisa membuat sistem yang menumpuk hasil (infinite scroll), tapi dalam tutorial ini kita memilih untuk mengganti hasil lama dengan yang baru agar lebih clean dan mudah dipahami.

**ğŸ‰ Hasil Setelah Fix:**

Sekarang saat klik Next:
- Hasil lama hilang âœ…
- Hasil baru muncul âœ…
- Pagination tidak dobel âœ…
- Info halaman update (Page 2 of 9) âœ…

---

<a name="event-listener-tombol-previous"></a>
## â®ï¸ Event Listener Tombol Previous

Sekarang kita akan menambahkan fungsi untuk tombol Previous agar bisa kembali ke halaman sebelumnya.

### âœ¨ Tambahkan di Fungsi `displayPagination()`:

```javascript
function displayPagination() {
  const div = document.createElement('div');
  div.classList.add('pagination');
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  document.querySelector('#pagination').appendChild(div);

  if (global.search.page === 1) {
    document.querySelector('#prev').disabled = true;
  }

  if (global.search.page === global.search.totalPages) {
    document.querySelector('#next').disabled = true;
  }

  // Event Listener untuk Next
  document.querySelector('#next').addEventListener('click', async () => {
    global.search.page++;
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });

  // ğŸ†• EVENT LISTENER UNTUK PREV
  document.querySelector('#prev').addEventListener('click', async () => {
    global.search.page--; // Decrement halaman (kurangi 1)
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });
}
```

**ğŸ’¡ Penjelasan:**

### Perbedaan dengan Next:

| Aspek | Next | Previous |
|-------|------|----------|
| **Selector** | `#next` | `#prev` |
| **Operasi** | `page++` (tambah) | `page--` (kurang) |
| **Fungsi** | Ke halaman selanjutnya | Ke halaman sebelumnya |

### Operator Decrement `--`

```javascript
global.search.page--;
```

- Operator `--` â†’ Mengurangi nilai sebesar 1
- Contoh: Jika page = 3, setelah `--` menjadi 2

**ğŸ”„ Alur Lengkap Saat Klik Previous:**
1. User klik tombol "Prev"
2. `global.search.page` berkurang 1 (misal dari 3 ke 2)
3. Request ke API dengan `page=2`
4. API mengembalikan hasil 21-40
5. Clear hasil lama
6. Tampilkan hasil halaman sebelumnya

---

<a name="testing-final"></a>
## âœ… Testing Final

Sekarang mari kita test semua fitur yang sudah kita buat!

### ğŸ¬ Test Case 1: Search "orphan"

**Initial State:**
```
Page 1 of 9
20 of 162 results for orphan
Prev: Disabled âœ…
Next: Active
```

**Klik Next:**
```
Page 2 of 9
20 of 162 results for orphan
Prev: Active
Next: Active
```

**Klik Next Lagi:**
```
Page 3 of 9
20 of 162 results for orphan
Prev: Active
Next: Active
```

**Keep Clicking Next sampai Page 9:**
```
Page 9 of 9
? of 162 results for orphan
Prev: Active
Next: Disabled âœ…
```

**Klik Prev:**
```
Page 8 of 9
Prev: Active
Next: Active
```

**Klik Prev sampai Page 1:**
```
Page 1 of 9
Prev: Disabled âœ…
Next: Active
```

### ğŸ“º Test Case 2: Search "the" (TV Shows)

**Kenapa search "the"?**
- Untuk mendapat banyak hasil
- Test dengan TV Shows (bukan Movies)
- Pastikan pagination works untuk kedua tipe

**Hasil:**
```
Page 1 of 500
20 of 10000 results for the
```

**Klik Next:**
```
Page 2 of 500
20 of 10000 results for the
âœ… Berhasil berpindah halaman!
```

### âœ… Checklist Testing:

- [x] Tombol Prev disabled di halaman pertama
- [x] Tombol Next disabled di halaman terakhir
- [x] Info halaman update saat klik Next/Prev
- [x] Hasil lama terhapus, hasil baru muncul
- [x] Tidak ada pagination dobel
- [x] Works untuk Movies
- [x] Works untuk TV Shows
- [x] Heading menampilkan jumlah hasil yang benar

**ğŸ‰ Semua fitur pagination sudah berfungsi dengan sempurna!**

---

<a name="kode-lengkap"></a>
## ğŸ“¦ Kode Lengkap

Berikut adalah kode lengkap setelah semua perubahan:

### ğŸ—„ï¸ Global State

```javascript
const global = {
  currentPage: window.location.pathname,
  search: {
    term: '',
    type: '',
    page: 1,
    totalPages: 1,
    totalResults: 0, // ğŸ†•
  },
  api: {
    apiKey: '3fd2be6f0c70a2a598f084ddfb75487c',
    apiUrl: 'https://api.themoviedb.org/3/',
  },
};
```

### ğŸ” Fungsi Search (Updated)

```javascript
async function search() {
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);

  global.search.type = urlParams.get('type');
  global.search.term = urlParams.get('search-term');

  if (global.search.term !== '' && global.search.term !== null) {
    // ğŸ”„ Destructure semua data pagination dari API
    const { results, total_pages, page, total_results } = await searchAPIData();

    // ğŸ†• Simpan ke global state
    global.search.page = page;
    global.search.totalPages = total_pages;
    global.search.totalResults = total_results;

    if (results.length === 0) {
      showAlert('No results found');
      return;
    }

    displaySearchResults(results);
    document.querySelector('#search-term').value = '';
  } else {
    showAlert('Please enter a search term');
  }
}
```

### ğŸ“Š Fungsi Display Search Results (Updated)

```javascript
function displaySearchResults(results) {
  // ğŸ§¹ CLEAR PREVIOUS RESULTS
  document.querySelector('#search-results').innerHTML = '';
  document.querySelector('#search-results-heading').innerHTML = '';
  document.querySelector('#pagination').innerHTML = '';

  results.forEach((result) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
          <a href="${global.search.type}-details.html?id=${result.id}">
            ${
              result.poster_path
                ? `<img
              src="https://image.tmdb.org/t/p/w500${result.poster_path}"
              class="card-img-top"
              alt="${
                global.search.type === 'movie' ? result.title : result.name
              }"
            />`
                : `<img
            src="../images/no-image.jpg"
            class="card-img-top"
             alt="${
               global.search.type === 'movie' ? result.title : result.name
             }"
          />`
            }
          </a>
          <div class="card-body">
            <h5 class="card-title">${
              global.search.type === 'movie' ? result.title : result.name
            }</h5>
            <p class="card-text">
              <small class="text-muted">Release: ${
                global.search.type === 'movie'
                  ? result.release_date
                  : result.first_air_date
              }</small>
            </p>
          </div>
        `;

    // ğŸ†• Tampilkan heading dengan informasi hasil
    document.querySelector('#search-results-heading').innerHTML = `
      <h2>${results.length} of ${global.search.totalResults} Results for ${global.search.term}</h2>
    `;

    document.querySelector('#search-results').appendChild(div);
  });

  // ğŸ†• Panggil fungsi pagination
  displayPagination();
}
```

### ğŸ¨ Fungsi Display Pagination (BARU)

```javascript
// Create & Display Pagination For Search
function displayPagination() {
  const div = document.createElement('div');
  div.classList.add('pagination');
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  document.querySelector('#pagination').appendChild(div);

  // Disable prev button if on first page
  if (global.search.page === 1) {
    document.querySelector('#prev').disabled = true;
  }

  // Disable next button if on last page
  if (global.search.page === global.search.totalPages) {
    document.querySelector('#next').disabled = true;
  }

  // ğŸ†• Next page
  document.querySelector('#next').addEventListener('click', async () => {
    global.search.page++;
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });

  // ğŸ†• Prev page
  document.querySelector('#prev').addEventListener('click', async () => {
    global.search.page--;
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });
}
```

### ğŸ”Œ Fungsi Search API Data (Updated)

```javascript
// Make Request To Search
async function searchAPIData() {
  const API_KEY = global.api.apiKey;
  const API_URL = global.api.apiUrl;

  showSpinner();

  const response = await fetch(
    `${API_URL}search/${global.search.type}?api_key=${API_KEY}&language=en-US&query=${global.search.term}&page=${global.search.page}`
    // ğŸ‘† Tambahkan parameter &page=
  );

  const data = await response.json();

  hideSpinner();

  return data;
}
```

### File: script.js (Versi Final)

```javascript
const global = {
  currentPage: window.location.pathname,
  search: {
    term: '',
    type: '',
    page: 1,
    totalPages: 1,
    totalResults: 0, // ğŸ†• TAMBAHAN BARU untuk pagination
  },
  api: {
    // Register your key at https://www.themoviedb.org/settings/api and enter here
    // Only use this for development or very small projects. You should store your key and make requests from a server
    apiKey: '3fd2be6f0c70a2a598f084ddfb75487c',
    apiUrl: 'https://api.themoviedb.org/3/',
  },
};

// Display 20 most popular movies
async function displayPopularMovies() {
  const { results } = await fetchAPIData('movie/popular');

  results.forEach((movie) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
          <a href="movie-details.html?id=${movie.id}">
            ${
              movie.poster_path
                ? `<img
              src="https://image.tmdb.org/t/p/w500${movie.poster_path}"
              class="card-img-top"
              alt="${movie.title}"
            />`
                : `<img
            src="../images/no-image.jpg"
            class="card-img-top"
            alt="${movie.title}"
          />`
            }
          </a>
          <div class="card-body">
            <h5 class="card-title">${movie.title}</h5>
            <p class="card-text">
              <small class="text-muted">Release: ${movie.release_date}</small>
            </p>
          </div>
        `;

    document.querySelector('#popular-movies').appendChild(div);
  });
}

// Display 20 most popular tv shows
async function displayPopularShows() {
  const { results } = await fetchAPIData('tv/popular');

  results.forEach((show) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
          <a href="tv-details.html?id=${show.id}">
            ${
              show.poster_path
                ? `<img
              src="https://image.tmdb.org/t/p/w500${show.poster_path}"
              class="card-img-top"
              alt="${show.name}"
            />`
                : `<img
            src="../images/no-image.jpg"
            class="card-img-top"
            alt="${show.name}"
          />`
            }
          </a>
          <div class="card-body">
            <h5 class="card-title">${show.name}</h5>
            <p class="card-text">
              <small class="text-muted">Air Date: ${show.first_air_date}</small>
            </p>
          </div>
        `;

    document.querySelector('#popular-shows').appendChild(div);
  });
}

// Display Movie Details
async function displayMovieDetails() {
  const movieId = window.location.search.split('=')[1];

  const movie = await fetchAPIData(`movie/${movieId}`);

  // Overlay for background image
  displayBackgroundImage('movie', movie.backdrop_path);

  const div = document.createElement('div');

  div.innerHTML = `
  <div class="details-top">
  <div>
  ${
    movie.poster_path
      ? `<img
    src="https://image.tmdb.org/t/p/w500${movie.poster_path}"
    class="card-img-top"
    alt="${movie.title}"
  />`
      : `<img
  src="../images/no-image.jpg"
  class="card-img-top"
  alt="${movie.title}"
/>`
  }
  </div>
  <div>
    <h2>${movie.title}</h2>
    <p>
      <i class="fas fa-star text-primary"></i>
      ${movie.vote_average.toFixed(1)} / 10
    </p>
    <p class="text-muted">Release Date: ${movie.release_date}</p>
    <p>
      ${movie.overview}
    </p>
    <h5>Genres</h5>
    <ul class="list-group">
      ${movie.genres.map((genre) => `<li>${genre.name}</li>`).join('')}
    </ul>
    <a href="${
      movie.homepage
    }" target="_blank" class="btn">Visit Movie Homepage</a>
  </div>
</div>
<div class="details-bottom">
  <h2>Movie Info</h2>
  <ul>
    <li><span class="text-secondary">Budget:</span> $${addCommasToNumber(
      movie.budget
    )}</li>
    <li><span class="text-secondary">Revenue:</span> $${addCommasToNumber(
      movie.revenue
    )}</li>
    <li><span class="text-secondary">Runtime:</span> ${
      movie.runtime
    } minutes</li>
    <li><span class="text-secondary">Status:</span> ${movie.status}</li>
  </ul>
  <h4>Production Companies</h4>
  <div class="list-group">
    ${movie.production_companies
      .map((company) => `<span>${company.name}</span>`)
      .join(', ')}
  </div>
</div>
  `;

  document.querySelector('#movie-details').appendChild(div);
}

// Display Show Details
async function displayShowDetails() {
  const showId = window.location.search.split('=')[1];

  const show = await fetchAPIData(`tv/${showId}`);

  // Overlay for background image
  displayBackgroundImage('tv', show.backdrop_path);

  const div = document.createElement('div');

  div.innerHTML = `
  <div class="details-top">
  <div>
  ${
    show.poster_path
      ? `<img
    src="https://image.tmdb.org/t/p/w500${show.poster_path}"
    class="card-img-top"
    alt="${show.name}"
  />`
      : `<img
  src="../images/no-image.jpg"
  class="card-img-top"
  alt="${show.name}"
/>`
  }
  </div>
  <div>
    <h2>${show.name}</h2>
    <p>
      <i class="fas fa-star text-primary"></i>
      ${show.vote_average.toFixed(1)} / 10
    </p>
    <p class="text-muted">Last Air Date: ${show.last_air_date}</p>
    <p>
      ${show.overview}
    </p>
    <h5>Genres</h5>
    <ul class="list-group">
      ${show.genres.map((genre) => `<li>${genre.name}</li>`).join('')}
    </ul>
    <a href="${
      show.homepage
    }" target="_blank" class="btn">Visit show Homepage</a>
  </div>
</div>
<div class="details-bottom">
  <h2>Show Info</h2>
  <ul>
    <li><span class="text-secondary">Number of Episodes:</span> ${
      show.number_of_episodes
    }</li>
    <li><span class="text-secondary">Last Episode To Air:</span> ${
      show.last_episode_to_air.name
    }</li>
    <li><span class="text-secondary">Status:</span> ${show.status}</li>
  </ul>
  <h4>Production Companies</h4>
  <div class="list-group">
    ${show.production_companies
      .map((company) => `<span>${company.name}</span>`)
      .join(', ')}
  </div>
</div>
  `;

  document.querySelector('#show-details').appendChild(div);
}

// Display Backdrop On Details Pages
function displayBackgroundImage(type, backgroundPath) {
  const overlayDiv = document.createElement('div');
  overlayDiv.style.backgroundImage = `url(https://image.tmdb.org/t/p/original/${backgroundPath})`;
  overlayDiv.style.backgroundSize = 'cover';
  overlayDiv.style.backgroundPosition = 'center';
  overlayDiv.style.backgroundRepeat = 'no-repeat';
  overlayDiv.style.height = '100vh';
  overlayDiv.style.width = '100vw';
  overlayDiv.style.position = 'absolute';
  overlayDiv.style.top = '0';
  overlayDiv.style.left = '0';
  overlayDiv.style.zIndex = '-1';
  overlayDiv.style.opacity = '0.1';

  if (type === 'movie') {
    document.querySelector('#movie-details').appendChild(overlayDiv);
  } else {
    document.querySelector('#show-details').appendChild(overlayDiv);
  }
}

// Search Movies/Shows
async function search() {
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);

  global.search.type = urlParams.get('type');
  global.search.term = urlParams.get('search-term');

  if (global.search.term !== '' && global.search.term !== null) {
    // ğŸ”„ UPDATE: Tambahkan total_results untuk pagination
    const { results, total_pages, page, total_results } = await searchAPIData();

    // ğŸ†• SIMPAN DATA PAGINATION ke global state
    global.search.page = page;
    global.search.totalPages = total_pages;
    global.search.totalResults = total_results;

    if (results.length === 0) {
      showAlert('No results found');
      return;
    }

    displaySearchResults(results);

    document.querySelector('#search-term').value = '';
  } else {
    showAlert('Please enter a search term');
  }
}

function displaySearchResults(results) {
  // ğŸ§¹ CLEAR PREVIOUS RESULTS - Tambahan baru untuk mencegah duplikasi
  document.querySelector('#search-results').innerHTML = '';
  document.querySelector('#search-results-heading').innerHTML = '';
  document.querySelector('#pagination').innerHTML = '';

  results.forEach((result) => {
    const div = document.createElement('div');
    div.classList.add('card');
    div.innerHTML = `
          <a href="${global.search.type}-details.html?id=${result.id}">
            ${
              result.poster_path
                ? `<img
              src="https://image.tmdb.org/t/p/w500${result.poster_path}"
              class="card-img-top"
              alt="${
                global.search.type === 'movie' ? result.title : result.name
              }"
            />`
                : `<img
            src="../images/no-image.jpg"
            class="card-img-top"
             alt="${
               global.search.type === 'movie' ? result.title : result.name
             }"
          />`
            }
          </a>
          <div class="card-body">
            <h5 class="card-title">${
              global.search.type === 'movie' ? result.title : result.name
            }</h5>
            <p class="card-text">
              <small class="text-muted">Release: ${
                global.search.type === 'movie'
                  ? result.release_date
                  : result.first_air_date
              }</small>
            </p>
          </div>
        `;

    // ğŸ†• HEADING HASIL PENCARIAN - Menampilkan "20 of 162 Results for orphan"
    document.querySelector('#search-results-heading').innerHTML = `
      <h2>${results.length} of ${global.search.totalResults} Results for ${global.search.term}</h2>
    `;

    document.querySelector('#search-results').appendChild(div);
  });

  // ğŸ†• PANGGIL FUNGSI PAGINATION
  displayPagination();
}

// ğŸ†• CREATE & DISPLAY PAGINATION FOR SEARCH - Fungsi baru!
function displayPagination() {
  const div = document.createElement('div');
  div.classList.add('pagination');
  div.innerHTML = `
    <button class="btn btn-primary" id="prev">Prev</button>
    <button class="btn btn-primary" id="next">Next</button>
    <div class="page-counter">Page ${global.search.page} of ${global.search.totalPages}</div>
  `;

  document.querySelector('#pagination').appendChild(div);

  // ğŸš« Disable prev button if on first page
  if (global.search.page === 1) {
    document.querySelector('#prev').disabled = true;
  }

  // ğŸš« Disable next button if on last page
  if (global.search.page === global.search.totalPages) {
    document.querySelector('#next').disabled = true;
  }

  // â­ï¸ Next page - Event listener untuk tombol Next
  document.querySelector('#next').addEventListener('click', async () => {
    global.search.page++; // Increment halaman
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });

  // â®ï¸ Prev page - Event listener untuk tombol Previous
  document.querySelector('#prev').addEventListener('click', async () => {
    global.search.page--; // Decrement halaman
    const { results, total_pages } = await searchAPIData();
    displaySearchResults(results);
  });
}

// Display Slider Movies
async function displaySlider() {
  const { results } = await fetchAPIData('movie/now_playing');

  results.forEach((movie) => {
    const div = document.createElement('div');
    div.classList.add('swiper-slide');

    div.innerHTML = `
      <a href="movie-details.html?id=${movie.id}">
        <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}" />
      </a>
      <h4 class="swiper-rating">
        <i class="fas fa-star text-secondary"></i> ${movie.vote_average} / 10
      </h4>
    `;

    document.querySelector('.swiper-wrapper').appendChild(div);

    initSwiper();
  });
}

function initSwiper() {
  const swiper = new Swiper('.swiper', {
    slidesPerView: 1,
    spaceBetween: 30,
    freeMode: true,
    loop: true,
    autoplay: {
      delay: 4000,
      disableOnInteraction: false,
    },
    breakpoints: {
      500: {
        slidesPerView: 2,
      },
      700: {
        slidesPerView: 3,
      },
      1200: {
        slidesPerView: 4,
      },
    },
  });
}

// Fetch data from TMDB API
async function fetchAPIData(endpoint) {
  const API_KEY = global.api.apiKey;
  const API_URL = global.api.apiUrl;

  showSpinner();

  const response = await fetch(
    `${API_URL}${endpoint}?api_key=${API_KEY}&language=en-US`
  );

  const data = await response.json();

  hideSpinner();

  return data;
}

// Make Request To Search
async function searchAPIData() {
  const API_KEY = global.api.apiKey;
  const API_URL = global.api.apiUrl;

  showSpinner();

  // ğŸ”„ UPDATE: Tambahkan &page=${global.search.page} untuk pagination
  const response = await fetch(
    `${API_URL}search/${global.search.type}?api_key=${API_KEY}&language=en-US&query=${global.search.term}&page=${global.search.page}`
  );

  const data = await response.json();

  hideSpinner();

  return data;
}

function showSpinner() {
  document.querySelector('.spinner').classList.add('show');
}

function hideSpinner() {
  document.querySelector('.spinner').classList.remove('show');
}

// Highlight active link
function highlightActiveLink() {
  const links = document.querySelectorAll('.nav-link');
  links.forEach((link) => {
    if (link.getAttribute('href') === global.currentPage) {
      link.classList.add('active');
    }
  });
}

// Show Alert
function showAlert(message, className = 'error') {
  const alertEl = document.createElement('div');
  alertEl.classList.add('alert', className);
  alertEl.appendChild(document.createTextNode(message));
  document.querySelector('#alert').appendChild(alertEl);

  setTimeout(() => alertEl.remove(), 3000);
}

function addCommasToNumber(number) {
  return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}

// Init App
function init() {
  switch (global.currentPage) {
    case '/':
    case '/index.html':
      displaySlider();
      displayPopularMovies();
      break;
    case '/shows.html':
      displayPopularShows();
      break;
    case '/movie-details.html':
      displayMovieDetails();
      break;
    case '/tv-details.html':
      displayShowDetails();
      break;
    case '/search.html':
      search();
      break;
  }

  highlightActiveLink();
}

document.addEventListener('DOMContentLoaded', init);
```

---

## ğŸ“ Rangkuman Pembelajaran

### âœ… Yang Sudah Kita Pelajari:

1. **ğŸ’¾ State Management**
   - Menambahkan `totalResults` ke global state
   - Menyimpan data pagination dari API

2. **ğŸ“Š Display Information**
   - Menampilkan heading hasil pencarian
   - Format: "20 of 162 Results for orphan"

3. **ğŸ¨ Dynamic Pagination**
   - Membuat tombol Prev dan Next secara dinamis
   - Menampilkan info halaman (Page 1 of 9)

4. **ğŸš« Conditional Logic**
   - Disable tombol Prev di halaman pertama
   - Disable tombol Next di halaman terakhir

5. **ğŸ”Œ API Integration**
   - Menambahkan parameter `page` ke API request
   - Mendapatkan hasil berbeda untuk setiap halaman

6. **âš¡ Event Handling**
   - Click event untuk tombol Next
   - Click event untuk tombol Previous

7. **ğŸ§¹ DOM Manipulation**
   - Clear hasil sebelumnya
   - Mencegah pagination dobel

8. **ğŸ› Debugging**
   - Fixing "total_results is not defined"
   - Fixing "totalPages is undefined"
   - Memahami snake_case vs camelCase

### ğŸ’¡ Best Practices yang Dipelajari:

- âœ… Konsistensi penamaan variabel (camelCase)
- âœ… Membersihkan DOM sebelum render ulang
- âœ… Menggunakan destructuring untuk data dari API
- âœ… Membuat fungsi terpisah untuk setiap fitur
- âœ… Testing di console untuk debugging

### ğŸš€ Pengembangan Selanjutnya:

Seperti yang disebutkan di video, kamu bisa mengembangkan aplikasi ini lebih lanjut dengan:

1. **ğŸ­ Cast & Crew Information**
   - Tampilkan daftar aktor seperti di IMDb
   - Klik aktor â†’ Menuju halaman profil aktor
   - Lihat filmografi lengkap

2. **ğŸ” Advanced Search**
   - Filter berdasarkan genre
   - Filter berdasarkan tahun
   - Sort by rating, popularity, dll

3. **â­ User Features**
   - Watchlist / Favorites
   - Rating system
   - Review system

4. **ğŸ“± UI/UX Improvements**
   - Infinite scroll pagination
   - Loading skeleton
   - Smooth transitions

5. **ğŸ¬ Trailer Integration**
   - Embed YouTube trailer
   - Play trailer modal

---

## ğŸ¯ Kesimpulan

Selamat! ğŸ‰ Kamu sudah berhasil membuat sistem pagination yang lengkap untuk aplikasi pencarian film. Fitur ini sangat penting karena:

- âœ… Meningkatkan User Experience
- âœ… Memuat data secara efisien (20 per halaman)
- âœ… Navigasi antar halaman yang mudah
- âœ… Informasi yang jelas tentang posisi halaman

**ğŸ“š Skill yang sudah dikuasai:**
- State management dengan JavaScript
- API integration dengan pagination
- Dynamic DOM manipulation
- Event handling
- Debugging dan problem solving

**ğŸ”¥ Next Steps:**
- Eksplorasi API documentation lebih lanjut
- Tambahkan fitur-fitur baru
- Improve UI/UX
- Deploy aplikasi online

Keep learning and happy coding! ğŸ’»âœ¨

---

> **ğŸ“ Catatan Penutup**: Dokumentasi ini dibuat sebagai catatan pembelajaran pribadi. Semua konsep dijelaskan step-by-step untuk memudahkan pemahaman bagi pemula. Jika ada pertanyaan atau ingin diskusi lebih lanjut, jangan ragu untuk eksplorasi lebih dalam!
