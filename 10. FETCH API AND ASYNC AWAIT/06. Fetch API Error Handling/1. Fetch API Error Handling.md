# ğŸš€ Error Handling dengan Fetch API - Dokumentasi Lengkap

> ğŸ“š Dokumentasi pribadi untuk pemula tentang penanganan error dalam Fetch API

---

## ğŸ“‘ Daftar Isi

- [Pengenalan](#pengenalan)
- [Status Code HTTP yang Umum](#status-code-http-yang-umum)
- [Perbedaan Fetch API dengan Library Lain](#perbedaan-fetch-api-dengan-library-lain)
- [Cara Fetch API Menangani Error](#cara-fetch-api-menangani-error)
  - [Request Sukses (200)](#request-sukses-200)
  - [Request Error (404)](#request-error-404)
  - [Network Error](#network-error)
- [Cara Mengecek Error dengan response.ok](#cara-mengecek-error-dengan-responseok)
- [Cara Mengecek Error dengan Status Code Spesifik](#cara-mengecek-error-dengan-status-code-spesifik)
- [Implementasi di Project Random User](#implementasi-di-project-random-user)
- [Kesimpulan](#kesimpulan)

---

<a name="pengenalan"></a>
## ğŸ¯ Pengenalan

Ketika kita membuat HTTP request menggunakan **Fetch API**, server tidak selalu mengembalikan response yang kita harapkan. Terkadang server mengembalikan **error status** seperti:

- âŒ **404** (Not Found)
- âŒ **401** (Unauthorized)
- âŒ **500** (Server Error)

Oleh karena itu, kita perlu **mengecek dan menangani error** yang mungkin terjadi agar aplikasi kita bisa bereaksi dengan baik terhadap berbagai kondisi error.

---

<a name="status-code-http-yang-umum"></a>
## ğŸ“Š Status Code HTTP yang Umum

Berikut adalah status code HTTP yang paling sering kita temui:

| Status Code | Kategori | Keterangan |
|------------|----------|------------|
| âœ… **200** | Success | Request berhasil |
| âœ… **201** | Success | Resource berhasil dibuat |
| âœ… **204** | Success | Berhasil tapi tidak ada content yang dikembalikan |
| ğŸ”„ **301** | Redirect | Resource telah dipindahkan |
| âš ï¸ **400** | Client Error | Bad Request |
| ğŸ”’ **401** | Client Error | Unauthorized (tidak ada akses) |
| ğŸš« **403** | Client Error | Forbidden (akses ditolak) |
| âŒ **404** | Client Error | Not Found (tidak ditemukan) |
| ğŸ’¥ **500** | Server Error | Internal Server Error |

> ğŸ’¡ **Tip**: Status code dalam range **200-299** = Sukses, selain itu = Ada masalah!

---

<a name="perbedaan-fetch-api-dengan-library-lain"></a>
## ğŸ”„ Perbedaan Fetch API dengan Library Lain

### âš¡ Fetch API vs Axios

**Axios** (third-party library):
- âœ… Otomatis menjalankan `.catch()` jika status bukan 200 range
- âœ… Lebih mudah untuk error handling

**Fetch API** (native JavaScript):
- âš ï¸ **TIDAK** otomatis menjalankan `.catch()` untuk error status
- âš ï¸ Kita harus **manual** mengecek response
- âœ… `.catch()` hanya berjalan untuk **network error**

---

<a name="cara-fetch-api-menangani-error"></a>
## ğŸ§ª Cara Fetch API Menangani Error

### ğŸ”§ Tools untuk Testing

Kita akan menggunakan **JSONPlaceholder** - API gratis untuk testing dan prototyping:

- `https://jsonplaceholder.typicode.com/posts/1` â†’ Mengembalikan status 200 (data exist)
- `https://jsonplaceholder.typicode.com/posts/999999` â†’ Mengembalikan status 404 (data tidak exist)
- URL tidak valid â†’ Network error

> ğŸ’¡ **Alternatif lain**: ReqRes.in (`https://reqres.in/api/users/1` untuk 200, `https://reqres.in/api/users/23` untuk 404)

---

<a name="request-sukses-200"></a>
### âœ… 1. Request Sukses (200)

```javascript
// Success - Status 200
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  });
```

**ğŸ“ Penjelasan:**
- Request ke endpoint yang mengembalikan status **200**
- `.then()` pertama menerima `response`
- `.then()` kedua menampilkan `'success'` di console
- âœ… Hasilnya: "success" muncul di console karena status 200

---

<a name="request-error-404"></a>
### âŒ 2. Request Error (404)

```javascript
// Issue: 'success' tetap muncul meski status 404!
fetch('https://jsonplaceholder.typicode.com/posts/999999')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });
```

**ğŸ“ Penjelasan:**
- Request ke endpoint dengan ID yang **tidak exist** (999999)
- Server mengembalikan status **404**
- âš ï¸ **Masalah**: `.then()` tetap berjalan dan menampilkan "success"
- âš ï¸ `.catch()` **TIDAK** berjalan meski status 404 adalah error
- Browser menampilkan 404 dengan warna merah, tapi kode kita tetap jalan normal

> ğŸš¨ **Peringatan**: Ini adalah perilaku aneh dari Fetch API yang sering membingungkan!

---

<a name="network-error"></a>
### ğŸŒ 3. Network Error

```javascript
// Catch HANYA berjalan pada network error
fetch('https://thissitedoesnotexist123456.com')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });
```

**ğŸ“ Penjelasan:**
- Request ke URL yang **tidak exist** (`thissitedoesnotexist123456.com`)
- Browser mencoba beberapa detik untuk connect
- âŒ Gagal connect = **Network Error**
- âœ… `.catch()` **BERJALAN** dan menampilkan error: `TypeError: Failed to fetch`
- `.then()` kedua **TIDAK** berjalan (tidak muncul "success")

> ğŸ’¡ **Kesimpulan**: `.catch()` pada Fetch API **HANYA** berjalan untuk **network error**, BUKAN untuk error status code seperti 404 atau 500!

---

<a name="cara-mengecek-error-dengan-responseok"></a>
## âœ”ï¸ Cara Mengecek Error dengan `response.ok`

Karena `.catch()` tidak otomatis berjalan untuk error status, kita harus **manual mengecek** response.

### ğŸ” Properti Response yang Bisa Dicek:

```javascript
fetch('https://jsonplaceholder.typicode.com/posts/999999')
  .then((response) => {
    console.log(response.status);      // 404
    console.log(response.ok);          // false
    console.log(response.statusText);  // "Not Found"
    return response;
  })
```

**ğŸ“ Penjelasan:**
- `response.status` â†’ Status code (contoh: 404)
- `response.ok` â†’ `true` jika status 200-299, `false` jika tidak
- `response.statusText` â†’ Text deskripsi (contoh: "Not Found")

---

### âœ… Cara Termudah: Cek `response.ok`

```javascript
// Test dengan response.ok
fetch('https://jsonplaceholder.typicode.com/posts/999999')
  .then((response) => {
    if (!response.ok) {
      throw new Error('Request Failed');
    }
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });
```

**ğŸ“ Penjelasan:**
1. Cek `!response.ok` (jika response **BUKAN** ok)
2. Jika tidak ok â†’ `throw new Error('Request Failed')`
3. Error yang di-throw akan **ditangkap** oleh `.catch()`
4. `.then()` kedua **TIDAK** berjalan
5. `.catch()` berjalan dan menampilkan: "Error: Request Failed"

> âœ… **Cara ini paling mudah** karena `response.ok` otomatis cek apakah status dalam range 200-299!

---

<a name="cara-mengecek-error-dengan-status-code-spesifik"></a>
## ğŸ¯ Cara Mengecek Error dengan Status Code Spesifik

Jika kita ingin memberikan **pesan error yang berbeda** untuk setiap status code:

```javascript
// Check untuk specific code
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then((response) => {
    if (response.status === 404) {
      throw new Error('Not Found');
    } else if (response.status === 500) {
      throw new Error('Server Error');
    } else if (response.status !== 200) {
      throw new Error('Request Failed');
    }
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });
```

**ğŸ“ Penjelasan:**

### ğŸ”¹ Jika status = 404
```javascript
if (response.status === 404) {
  throw new Error('Not Found');
}
```
- Error message: "Not Found"

### ğŸ”¹ Jika status = 500
```javascript
else if (response.status === 500) {
  throw new Error('Server Error');
}
```
- Error message: "Server Error"

### ğŸ”¹ Jika status bukan 200
```javascript
else if (response.status !== 200) {
  throw new Error('Request Failed');
}
```
- Error message: "Request Failed"
- Ini akan menangkap semua error status lainnya (401, 403, dll)

### ğŸ”¹ Jika status = 200
```javascript
return response;
```
- Lanjut ke `.then()` berikutnya
- Tampilkan "success"

> ğŸ’¡ **Kapan pakai cara ini?** Ketika kita ingin memberikan **pesan error yang spesifik** untuk setiap jenis error!

---

<a name="implementasi-di-project-random-user"></a>
## ğŸ¨ Implementasi di Project Random User

Sekarang kita akan menerapkan error handling ke project **Random User** yang sudah dibuat sebelumnya.

### ğŸ“‚ File Structure
```
project/
â”œâ”€â”€ index.html
â”œâ”€â”€ style.css (dengan Tailwind)
â””â”€â”€ script.js
```

### ğŸ“„ index.html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetch API Error Handling</title>
  </head>
  <body>
    <h1>Fetch API Error Handling</h1>

    <script src="./script.js"></script>
  </body>
</html>
```

---

### ğŸ“ script.js - SEBELUM Error Handling

```javascript
function fetchUser() {
  showSpinner();
  
  fetch('https://randomuser.me/api')
    .then((res) => res.json())
    .then((data) => {
      hideSpinner();
      displayUser(data.results[0]);
    });
}
```

**âŒ Masalah:**
- Tidak ada pengecekan error
- Jika API error, aplikasi akan hang
- User tidak tahu ada masalah

---

### âœ… script.js - SETELAH Error Handling

```javascript
function fetchUser() {
  showSpinner();
  
  fetch('https://randomuser.me/api')
    .then((res) => {
      // âœ… Cek jika response tidak ok
      if (!res.ok) {
        throw new Error('Request Failed');
      }
      return res.json();
    })
    .then((data) => {
      hideSpinner();
      displayUser(data.results[0]);
    })
    .catch((error) => {
      // âœ… Tangani error
      hideSpinner();
      
      // Tampilkan error ke user
      document.querySelector('#user').innerHTML = `
        <p class="text-xl text-red-500 mb-5">
          ${error}
        </p>
      `;
    });
}
```

**ğŸ“ Penjelasan Step-by-Step:**

### ğŸ”¹ Step 1: Cek Response
```javascript
.then((res) => {
  if (!res.ok) {
    throw new Error('Request Failed');
  }
  return res.json();
})
```
- Tambahkan `{}` untuk menulis multiple statement
- Cek `!res.ok`
- Jika error â†’ throw error
- Jika ok â†’ return `res.json()`

### ğŸ”¹ Step 2: Tambahkan `.catch()`
```javascript
.catch((error) => {
  hideSpinner();
  
  document.querySelector('#user').innerHTML = `
    <p class="text-xl text-red-500 mb-5">
      ${error}
    </p>
  `;
})
```
- **Sembunyikan spinner** (penting! agar spinner tidak terus muter)
- Ambil element dengan id `#user`
- Ganti isinya dengan pesan error
- Styling dengan Tailwind: `text-xl`, `text-red-500`, `mb-5`

---

### ğŸ§ª Testing Error Handling

#### âœ… Test 1: URL Benar
```javascript
fetch('https://randomuser.me/api')
```
- Status: 200
- Hasil: Data user ditampilkan âœ…

#### âŒ Test 2: URL Salah (404)
```javascript
fetch('https://randomuser.me/api1')  // API dengan '1' di akhir
```
- Status: 404
- Hasil: Muncul pesan error merah "Request Failed" âœ…
- Spinner hilang âœ…

#### âŒ Test 3: Network Error
```javascript
fetch('https://invaliddomain12345.com')
```
- Hasil: Muncul pesan error "Failed to fetch" âœ…
- Spinner hilang âœ…

> ğŸ‰ **Berhasil!** Aplikasi sekarang bisa menangani error dengan baik!

---

## ğŸ“‹ File Praktik Lengkap

### ğŸ“„ index.html
```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetch API Error Handling</title>
  </head>
  <body>
    <h1>Fetch API Error Handling</h1>

    <script src="./index.js"></script>
  </body>
</html>
```

### ğŸ“„ index.js
```javascript
// ==========================================
// 1. SUCCESS - Status 200
// ==========================================
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  });


// ==========================================
// 2. ERROR STATUS (404) - .catch() TIDAK BERJALAN!
// ==========================================
// Issue: 'success' tetap muncul dan .catch() TIDAK berjalan
fetch('https://jsonplaceholder.typicode.com/posts/999999')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });


// ==========================================
// 3. NETWORK ERROR - .catch() BERJALAN
// ==========================================
// Catch HANYA berjalan pada network error
fetch('https://thissitedoesnotexist123456.com')
  .then((response) => {
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });


// ==========================================
// 4. SOLUSI: Test dengan response.ok
// ==========================================
fetch('https://jsonplaceholder.typicode.com/posts/999999')
  .then((response) => {
    if (!response.ok) {
      throw new Error('Request Failed');
    }
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });


// ==========================================
// 5. SOLUSI: Check untuk specific status code
// ==========================================
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then((response) => {
    if (response.status === 404) {
      throw new Error('Not Found');
    } else if (response.status === 500) {
      throw new Error('Server Error');
    } else if (response.status !== 200) {
      throw new Error('Request Failed');
    }
    return response;
  })
  .then(() => {
    console.log('success');
  })
  .catch((error) => {
    console.log(error);
  });
```

---

<a name="kesimpulan"></a>
## ğŸ“ Kesimpulan

### ğŸ“Œ Poin-Poin Penting:

1. **âš ï¸ Fetch API TIDAK otomatis throw error** untuk status code seperti 404 atau 500
2. **âœ… `.catch()` hanya berjalan** untuk **network error**
3. **ğŸ” Kita harus manual mengecek** response dengan:
   - `response.ok` (cara termudah)
   - `response.status` (untuk pengecekan spesifik)
4. **ğŸ¯ Gunakan `throw new Error()`** untuk memicu `.catch()`
5. **ğŸ’¡ Selalu handle error** terutama saat bekerja dengan third-party API

---

### ğŸ› ï¸ Best Practices:

âœ… **DO:**
- Selalu tambahkan error handling
- Gunakan `response.ok` untuk pengecekan umum
- Berikan pesan error yang jelas ke user
- Sembunyikan loading spinner saat error

âŒ **DON'T:**
- Jangan asumsikan request selalu sukses
- Jangan biarkan aplikasi hang tanpa feedback
- Jangan bergantung pada `.catch()` untuk menangkap error status

---

### ğŸ”§ API untuk Testing Error Handling:

| API | URL | Keterangan |
|-----|-----|------------|
| âœ… **JSONPlaceholder** | `https://jsonplaceholder.typicode.com` | Gratis, reliable, support 404 |
| âœ… **ReqRes** | `https://reqres.in` | Khusus testing, delay support |
| âœ… **Random User** | `https://randomuser.me/api` | Generate random user data |

---

### ğŸš€ Langkah Selanjutnya:

Setelah memahami error handling, kamu bisa:
1. Implementasikan di semua fetch request kamu
2. Customize pesan error untuk berbagai status code
3. Pelajari async/await untuk syntax yang lebih clean
4. Pelajari retry mechanism untuk failed request

---

> ğŸ’ª **Selamat!** Kamu sekarang sudah paham cara menangani error dengan Fetch API!

---

ğŸ“… *Dibuat untuk pembelajaran pribadi*  
ğŸ”– *Versi: 1.0*  
ğŸ”„ *Updated: Menggunakan JSONPlaceholder & ReqRes.in*
